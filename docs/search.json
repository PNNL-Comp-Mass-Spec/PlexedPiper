[{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos.html","id":"data-source","dir":"Articles","previous_headings":"","what":"Data source","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data.\n","text":"vignette demonstrates processing usign PNNL’s DMS data source. PNNL DMS based MS SQL Server. Typically data organized data packages according experiments. Data package contains phospho data mirroring PlexedPiperTestData number 3626. Smaller version data package, suggested testing purposes 3625.","code":"data_package_num <- 3625 # if there is no connection to PNNL DMS, vignette is not compiled if(!is_PNNL_DMS_connection_successful()){   message(\"There is no connection to PNNL DMS. This code in this vignette won't be evaluated.\")   knitr::opts_chunk$set(eval = FALSE) }"},{"path":[]},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos.html","id":"read-the-ms-gf-output","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Read the MS-GF+ output","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data.\n","text":"First step determine MS-GF+ jobs using data package number. simply reads parsed text output MS-GF+ search engine. text files collated together resulting data.frame used create MSnID object. Phospho dataset involve Ascore jobs improving phospho-site localization. one Ascore job per data package. fetched object data.frame links datasets, scans original PTM localization newly suggested locations. Importantly contains AScore column signifies confidence PTM assingment. AScore > 17 considered confident. Remove non-phospho. Need sure phospho symbol *! FDR filter peptide level. Remapping IDs RefSeq gene symbols MSnID object FASTA file use search. Double checking FASTA file. Note, case multiple RefSeq mapping gene, picked RefSeq entry longest sequence. Unfortunately, unlike UniProt, RefSeq report, sequence considered canonical. resolve ambiguity resort protein length. Mapping sites protein sequence. lot cases easier handle interpret example, Hrc-T379t, rather peptide sequence D.DDDNDGGST*ENVHQAHR.H .","code":"msnid <- read_msgf_data_from_DMS(data_package_num) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 101202 at 61 % FDR ## #peptides: 76398 at 75 % FDR ## #accessions: 78483 at 94 % FDR ascore <- get_AScore_results(data_package_num) msnid <- best_PTM_location_by_ascore(msnid, ascore) msnid <- apply_filter(msnid, \"grepl(\\\"\\\\\\\\*\\\", peptide)\") msnid <- filter_msgf_data_peptide_level(msnid, 0.01) conv_tbl <- fetch_conversion_table(organism_name = \"Rattus norvegicus\",                                    from = \"REFSEQ\", to = \"SYMBOL\")  msnid <- remap_accessions_refseq_to_gene(msnid,                                          conversion_table = conv_tbl)  # Remove missing accessions psms(msnid) <- dplyr::filter(psms(msnid), !is.na(accession))  fst_dms_pth <- path_to_FASTA_used_by_DMS(data_package_num) fst_dms_pth_2 <- remap_accessions_refseq_to_gene_fasta(   fst_dms_pth, conversion_table = conv_tbl ) library(Biostrings) fst <- readAAStringSet(fst_dms_pth_2) msnid <- map_mod_sites(msnid, fst,                         accession_col = \"accession\",                         peptide_mod_col = \"peptide\",                         mod_char = \"*\",                        site_delimiter = \"lower\") head(psms(msnid)) ##                                                 Dataset ResultID  Scan ## 1 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03        1 25367 ## 2 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03        5 32449 ## 3 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03        6 32449 ## 4 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03        7 26428 ## 5 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03        8 26428 ## 6 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03        9 26428 ##   FragMethod SpecIndex Charge PrecursorMZ     DelM DelM_PPM       MH ## 1        HCD         1      4    972.0253 -0.00036  -0.0932 3883.073 ## 2        HCD         4      3   1067.8135 -0.00030  -0.0946 3200.422 ## 3        HCD         4      3   1067.8135 -0.00030  -0.0946 3200.422 ## 4        HCD         5      3   1011.8371 -0.01384  -4.5651 3032.507 ## 5        HCD         5      3   1011.8371 -0.01384  -4.5651 3032.507 ## 6        HCD         5      3   1011.8371 -0.01384  -4.5651 3032.507 ##                       OriginalPeptide        Protein NTT DeNovoScore MSGFScore ## 1 R.RRPT*PATLVLTSDQSSPEVDEDRIPNPLLK.S    NP_073167.1   2         214       191 ## 2  R.AGGAES*GPEEDALSLGAEACNFMQPLGGR.S NP_001292067.1   2         183       160 ## 3  R.AGGAES*GPEEDALSLGAEACNFMQPLGGR.S NP_001292068.1   2         183       160 ## 4    R.VASS*SQELAQVGPAAMLNGQSLQSPPR.A NP_001292067.1   2         151       136 ## 5    R.VASS*SQELAQVGPAAMLNGQSLQSPPR.A NP_001292068.1   2         151       136 ## 6    R.VASSS*QELAQVGPAAMLNGQSLQSPPR.A NP_001292067.1   2         151       136 ##   MSGFDB_SpecEValue Rank_MSGFDB_SpecEValue     EValue QValue PepQValue ## 1        5.6808e-27                      1 1.4918e-19      0         0 ## 2        8.7345e-24                      1 2.2851e-16      0         0 ## 3        8.7345e-24                      1 2.2851e-16      0         0 ## 4        3.5277e-23                      1 9.1588e-16      0         0 ## 5        3.5277e-23                      1 9.1588e-16      0         0 ## 6        3.5277e-23                      1 9.1588e-16      0         0 ##   IsotopeError accession calculatedMassToCharge chargeState ## 1            2   Ppp1r1a               971.5236           4 ## 2            1   Synpo2l              1067.4788           3 ## 3            1   Synpo2l              1067.4788           3 ## 4            1   Synpo2l              1011.5072           3 ## 5            1   Synpo2l              1011.5072           3 ## 6            1   Synpo2l              1011.5072           3 ##   experimentalMassToCharge isDecoy ## 1                 972.0253   FALSE ## 2                1067.8135   FALSE ## 3                1067.8135   FALSE ## 4                1011.8371   FALSE ## 5                1011.8371   FALSE ## 6                1011.8371   FALSE ##                                            spectrumFile spectrumID ## 1 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      25367 ## 2 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      32449 ## 3 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      32449 ## 4 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      26428 ## 5 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      26428 ## 6 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      26428 ##                           pepSeq                             peptide maxAScore ## 1 RRPTPATLVLTSDQSSPEVDEDRIPNPLLK R.RRPTPAT*LVLTSDQSSPEVDEDRIPNPLLK.S      0.00 ## 2  AGGAESGPEEDALSLGAEACNFMQPLGGR  R.AGGAES*GPEEDALSLGAEACNFMQPLGGR.S    108.68 ## 3  AGGAESGPEEDALSLGAEACNFMQPLGGR  R.AGGAES*GPEEDALSLGAEACNFMQPLGGR.S    108.68 ## 4    VASSSQELAQVGPAAMLNGQSLQSPPR    R.VASSS*QELAQVGPAAMLNGQSLQSPPR.A      0.00 ## 5    VASSSQELAQVGPAAMLNGQSLQSPPR    R.VASSS*QELAQVGPAAMLNGQSLQSPPR.A      0.00 ## 6    VASSSQELAQVGPAAMLNGQSLQSPPR    R.VASSS*QELAQVGPAAMLNGQSLQSPPR.A      0.00 ##   msmsScore absParentMassErrorPPM First_AA Last_AA First_AA_First Last_AA_First ## 1       Inf              516.3443       32      61             32            61 ## 2       Inf              313.5238      665     693            665           693 ## 3       Inf              313.5238      665     693            665           693 ## 4       Inf              326.1740      399     425            399           425 ## 5       Inf              326.1740      399     425            399           425 ## 6       Inf              326.1740      399     425            399           425 ##   ProtLen ModShift ModAAs SiteLoc Site SiteCollapsed SiteCollapsedFirst ## 1     171        6      T      38  T38           T38                T38 ## 2     978        5      S     670 S670          S670               S670 ## 3     978        5      S     670 S670          S670               S670 ## 4     978        4      S     403 S403          S403               S403 ## 5     978        4      S     403 S403          S403               S403 ## 6     978        4      S     403 S403          S403               S403 ##          SiteID ## 1  Ppp1r1a-T38t ## 2 Synpo2l-S670s ## 3 Synpo2l-S670s ## 4 Synpo2l-S403s ## 5 Synpo2l-S403s ## 6 Synpo2l-S403s"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos.html","id":"inference-of-parsimonius-set","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Inference of parsimonius set","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data.\n","text":"Inference parsimonius step skipped pipeline. Remapping RefSeq IDs gene symbols helped situation ambiguous assignment. Demo inference available vignettes.","code":""},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos.html","id":"prepare-masic-reporter-ion-intensities","dir":"Articles","previous_headings":"","what":"Prepare MASIC reporter ion intensities","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data.\n","text":"Fetching preparing reporter intensities based MASIC ouput.","code":"masic_data <- read_masic_data_from_DMS(data_package_num,                                         interference_score = T) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% masic_data <- filter_masic_data(masic_data, 0.5, 0)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos.html","id":"fetch-study-design-tables","dir":"Articles","previous_headings":"","what":"Fetch study design tables","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data.\n","text":"","code":"study_design_tables <- get_study_design_by_dataset_package(data_package_num) fractions <- study_design_tables$fractions samples <- study_design_tables$samples references <- study_design_tables$references"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos.html","id":"create-cross-tab","dir":"Articles","previous_headings":"","what":"Create cross-tab","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data.\n","text":"","code":"msnid <- apply_filter(msnid, \"!isDecoy\") aggregation_level <- c(\"SiteID\") quant_cross_tab <- create_crosstab(msnid,                                     masic_data,                                     aggregation_level,                                     fractions, samples, references) dim(quant_cross_tab) ## [1] 2664   18 head(quant_cross_tab) ##                        R_01       R_02       R_03        R_04       R_05 ## Aak1-S639s      -0.54798756 -0.3528221 -0.7591084 -0.46518317 -0.6804685 ## Aak1-S654s      -0.71609119  0.0765027 -0.7579839  0.05178725 -0.1498719 ## Aak1-T622t      -0.74928181  0.2854943 -0.8824194 -0.08552446 -0.4203140 ## Aak1-T622tS625s -0.33932480 -0.1138501 -0.6839385 -0.29876678 -0.7197100 ## Aak1-T622tS626s -0.09656509 -0.1443662 -0.8625578 -0.02124223 -0.4023948 ## Aak1-T642t               NA         NA         NA          NA         NA ##                       R_06        R_07       R_08       R_09        S_01 ## Aak1-S639s      -0.9119027 -0.92375075 -0.4898818 -0.0768597 -0.58033854 ## Aak1-S654s              NA          NA         NA         NA -0.17215866 ## Aak1-T622t              NA          NA         NA         NA -0.07470210 ## Aak1-T622tS625s         NA          NA         NA         NA -0.23722213 ## Aak1-T622tS626s         NA          NA         NA         NA -0.09324999 ## Aak1-T642t      -0.9341165 -0.06627768 -0.5125054  0.6196574          NA ##                       S_02        S_03       S_04       S_05        S_06 ## Aak1-S639s      -0.7859280 -0.71737909 -1.0244423 -0.2834428 -0.31012621 ## Aak1-S654s      -2.3020472 -0.02275759 -0.8836703         NA          NA ## Aak1-T622t      -0.8574086 -0.39572365 -1.3884452         NA          NA ## Aak1-T622tS625s -0.9075300 -0.45022446 -0.9482141         NA          NA ## Aak1-T622tS626s -0.8809523 -0.19529207 -0.9904356         NA          NA ## Aak1-T642t              NA          NA         NA  0.4282869 -0.05693969 ##                       S_07       S_08       S_09 ## Aak1-S639s      -0.6066893 -0.7573615 -0.6125626 ## Aak1-S654s              NA         NA         NA ## Aak1-T622t              NA         NA         NA ## Aak1-T622tS625s         NA         NA         NA ## Aak1-T622tS626s         NA         NA         NA ## Aak1-T642t      -0.2881371 -0.8504565 -0.7601273"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"data-source","dir":"Articles","previous_headings":"","what":"Data source","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"vignette demonstrates processing usign PNNL’s DMS data source. PNNL DMS based MS SQL Server. Typically data organized data packages according experiments. Data package contains phospho data mirroring PlexedPiperTestData number 3626. Smaller version data package, suggested testing purposes 3625.","code":"data_package_num <- 3625 # if there is no connection to PNNL DMS, vignette is not compiled if(!is_PNNL_DMS_connection_successful()){    message(\"There is no connection to PNNL DMS. This code in this vignette won't be evaluated.\")    knitr::opts_chunk$set(eval = FALSE) }"},{"path":[]},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"read-the-ms-gf-output","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Read the MS-GF+ output","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"First step determine MS-GF+ jobs using data package number. simply reads parsed text output MS-GF+ search engine. text files collated together resulting data.frame used create MSnID object.","code":"msnid <- read_msgf_data_from_DMS(data_package_num) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 101202 at 61 % FDR ## #peptides: 76398 at 75 % FDR ## #accessions: 78483 at 94 % FDR"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"ascore","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"AScore","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"Phospho dataset involve Ascore jobs improving phospho-site localization. one Ascore job per data package. fetched object data.frame links datasets, scans original PTM localization newly suggested locations. Importantly contains AScore column signifies confidence PTM assingment. AScore > 17 considered confident. Remove non-phospho. Need sure phospho symbol *!","code":"ascore <- get_AScore_results(data_package_num) msnid <- best_PTM_location_by_ascore(msnid, ascore) msnid <- apply_filter(msnid, \"grepl(\\\"\\\\\\\\*\\\", peptide)\")"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"fdr-filter","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"FDR filter","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"FDR filter peptide level.","code":"msnid <- filter_msgf_data_peptide_level(msnid, 0.01)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"inference-of-parsimonius-set","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Inference of parsimonius set","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"","code":"msnid <- infer_parsimonious_accessions(msnid)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"mapping-sites-to-protein-sequence","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Mapping sites to protein sequence","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"Mapping sites protein sequence. Call creates number columns describing mapping site/s onto protein sequences. important user SiteID. Prepare FASTA make sure entry names FASTA file match MSnID accessions. plan make conversion automatic. Note, type ID extraction ignore non-RefSeq entries contaminants. Mapping main call.","code":"fst_dms_pth <- path_to_FASTA_used_by_DMS(data_package_num) fst <- readAAStringSet(fst_dms_pth) names(fst) <- gsub(\" .*\", \"\", names(fst)) # names must match accessions msnid <- map_mod_sites(msnid, fst,                         accession_col = \"accession\",                         peptide_mod_col = \"peptide\",                         mod_char = \"*\",                        site_delimiter = \"lower\") head(psms(msnid)) ##                                                 Dataset ResultID  Scan ## 1 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      408 32861 ## 2 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      414 31457 ## 3 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      636 33482 ## 4 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      641 33163 ## 5 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      664 33807 ## 6 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      701 34776 ##   FragMethod SpecIndex Charge PrecursorMZ     DelM DelM_PPM      MH ## 1        HCD        86      3    991.8065 -0.00530  -1.7846 2973.41 ## 2        HCD        88      3    991.8090  0.00201   0.6769 2973.41 ## 3        HCD       119      3    992.1422 -0.00158  -0.5326 2973.41 ## 4        HCD       123      3    992.1429  0.00043   0.1443 2973.41 ## 5        HCD       132      3    992.1419 -0.00250  -0.8403 2973.41 ## 6        HCD       145      3    992.4756 -0.00463  -1.5576 2973.41 ##               OriginalPeptide     Protein NTT DeNovoScore MSGFScore ## 1 R.AAAEGSS*NVFSMFDQTQIQEFK.E NP_036737.1   2         144       114 ## 2 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         124       108 ## 3 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         134       112 ## 4 R.AAAEGSS*NVFSMFDQTQIQEFK.E NP_036737.1   2         136       110 ## 5 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         133       101 ## 6 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         123       104 ##   MSGFDB_SpecEValue Rank_MSGFDB_SpecEValue     EValue QValue PepQValue ## 1        1.3776e-17                      1 3.5033e-10      0         0 ## 2        1.5700e-17                      1 3.9924e-10      0         0 ## 3        3.9576e-17                      1 1.0064e-09      0         0 ## 4        4.4128e-17                      1 1.1222e-09      0         0 ## 5        7.3846e-17                      1 1.8779e-09      0         0 ## 6        1.3331e-16                      1 3.3901e-09      0         0 ##   IsotopeError   accession calculatedMassToCharge chargeState ## 1            0 NP_036737.1               991.8083           3 ## 2            0 NP_036737.1               991.8083           3 ## 3            1 NP_036737.1               991.8083           3 ## 4            1 NP_036737.1               991.8083           3 ## 5            1 NP_036737.1               991.8083           3 ## 6            2 NP_036737.1               991.8083           3 ##   experimentalMassToCharge isDecoy ## 1                 991.8065   FALSE ## 2                 991.8090   FALSE ## 3                 992.1422   FALSE ## 4                 992.1429   FALSE ## 5                 992.1419   FALSE ## 6                 992.4756   FALSE ##                                            spectrumFile spectrumID ## 1 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      32861 ## 2 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      31457 ## 3 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      33482 ## 4 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      33163 ## 5 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      33807 ## 6 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      34776 ##                   pepSeq                     peptide maxAScore msmsScore ## 1 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 2 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    18.255       Inf ## 3 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 4 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 5 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 6 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ##   absParentMassErrorPPM First_AA Last_AA First_AA_First Last_AA_First ProtLen ## 1             1.7627512       10      31             10            31     169 ## 2             0.6974017       10      31             10            31     169 ## 3           336.6998436       10      31             10            31     169 ## 4           337.3753774       10      31             10            31     169 ## 5           336.3973658       10      31             10            31     169 ## 6           672.8938547       10      31             10            31     169 ##   ModShift ModAAs SiteLoc Site SiteCollapsed SiteCollapsedFirst ## 1        6      S      16  S16           S16                S16 ## 2        6      S      16  S16           S16                S16 ## 3        6      S      16  S16           S16                S16 ## 4        6      S      16  S16           S16                S16 ## 5        6      S      16  S16           S16                S16 ## 6        6      S      16  S16           S16                S16 ##             SiteID ## 1 NP_036737.1-S16s ## 2 NP_036737.1-S16s ## 3 NP_036737.1-S16s ## 4 NP_036737.1-S16s ## 5 NP_036737.1-S16s ## 6 NP_036737.1-S16s"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"prepare-masic-reporter-ion-intensities","dir":"Articles","previous_headings":"","what":"Prepare MASIC reporter ion intensities","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"Fetching preparing reporter intensities based MASIC ouput.","code":"masic_data <- read_masic_data_from_DMS(data_package_num,                                         interference_score = T) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% masic_data <- filter_masic_data(masic_data, 0.5, 0)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"fetch-study-design-tables","dir":"Articles","previous_headings":"","what":"Fetch study design tables","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"","code":"study_design_tables <- get_study_design_by_dataset_package(data_package_num) fractions <- study_design_tables$fractions samples <- study_design_tables$samples references <- study_design_tables$references"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"create-cross-tab","dir":"Articles","previous_headings":"","what":"Create cross-tab","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"Aggregation done directly SiteID level.","code":"msnid <- apply_filter(msnid, \"!isDecoy\") aggregation_level <- c(\"SiteID\") quant_cross_tab <- create_crosstab(msnid,                                     masic_data,                                     aggregation_level,                                     fractions, samples, references) dim(quant_cross_tab) ## [1] 3002   18 head(quant_cross_tab) ##                            R_01       R_02       R_03       R_04      R_05 ## NP_001001514.1-T378t         NA         NA         NA         NA        NA ## NP_001002016.2-S633s         NA         NA         NA         NA        NA ## NP_001002022.1-S232s         NA         NA         NA         NA        NA ## NP_001002277.1-S975s  -0.221334 -0.2668764 -0.4962683 -0.6486341 -0.502687 ## NP_001002823.2-S2624s        NA         NA         NA         NA        NA ## NP_001002823.2-S382s         NA         NA         NA         NA        NA ##                             R_06       R_07        R_08        R_09    S_01 ## NP_001001514.1-T378t  -0.9102728  0.1452157  0.29764868  1.06356080      NA ## NP_001002016.2-S633s  -0.8376728 -0.1266532 -0.47675809 -0.16171559      NA ## NP_001002022.1-S232s  -0.3585890 -1.1223969 -0.08709753  0.01915121      NA ## NP_001002277.1-S975s  -0.7197738 -0.4621769 -0.57432542 -0.08255740 -1.1161 ## NP_001002823.2-S2624s -0.9991695 -0.6964205 -0.69518658 -0.19798040      NA ## NP_001002823.2-S382s  -1.0497954 -0.4427657 -0.57543361 -0.31050097      NA ##                             S_02       S_03      S_04        S_05       S_06 ## NP_001001514.1-T378t          NA         NA        NA -0.42961520  0.1019106 ## NP_001002016.2-S633s          NA         NA        NA -0.37916148 -0.4258262 ## NP_001002022.1-S232s          NA         NA        NA -0.82186420 -0.4086093 ## NP_001002277.1-S975s  -0.9010645 -0.4331578 -1.252771 -0.31265712 -0.4093047 ## NP_001002823.2-S2624s         NA         NA        NA -0.04835898 -0.6610427 ## NP_001002823.2-S382s          NA         NA        NA -0.40651275 -0.5312910 ##                             S_07       S_08       S_09 ## NP_001001514.1-T378t   0.3944213 -0.7471462  0.4104976 ## NP_001002016.2-S633s  -0.3930587 -0.8900900 -0.4564657 ## NP_001002022.1-S232s  -0.5548583 -0.8992825 -0.5314916 ## NP_001002277.1-S975s  -0.5465060 -0.4536835 -0.6120104 ## NP_001002823.2-S2624s -0.6116665 -0.7012145 -0.5859379 ## NP_001002823.2-S382s  -0.8688640 -0.7859765 -0.4081825"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_MoTrPAC.html","id":"post-processing--linking-with-ascores","dir":"Articles","previous_headings":"","what":"Post-processing. Linking with AScores","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project.\n","text":"","code":"x_ascore <-    psms(msnid) %>%    group_by(SiteID) %>%   summarise(maxAScore = max(maxAScore))  x <- quant_cross_tab %>%   as.data.frame() %>%   tibble::rownames_to_column(\"SiteID\") %>%   inner_join(x_ascore) %>%   mutate(ConfidentSite = maxAScore > 17) %>%   dplyr::select(SiteID, maxAScore, ConfidentSite, everything()) head(x) ##                  SiteID maxAScore ConfidentSite      R_01       R_02       R_03 ## 1  NP_001001514.1-T378t    17.980          TRUE        NA         NA         NA ## 2  NP_001002016.2-S633s    58.252          TRUE        NA         NA         NA ## 3  NP_001002022.1-S232s     0.000         FALSE        NA         NA         NA ## 4  NP_001002277.1-S975s    98.625          TRUE -0.221334 -0.2668764 -0.4962683 ## 5 NP_001002823.2-S2624s    34.792          TRUE        NA         NA         NA ## 6  NP_001002823.2-S382s    52.139          TRUE        NA         NA         NA ##         R_04      R_05       R_06       R_07        R_08        R_09    S_01 ## 1         NA        NA -0.9102728  0.1452157  0.29764868  1.06356080      NA ## 2         NA        NA -0.8376728 -0.1266532 -0.47675809 -0.16171559      NA ## 3         NA        NA -0.3585890 -1.1223969 -0.08709753  0.01915121      NA ## 4 -0.6486341 -0.502687 -0.7197738 -0.4621769 -0.57432542 -0.08255740 -1.1161 ## 5         NA        NA -0.9991695 -0.6964205 -0.69518658 -0.19798040      NA ## 6         NA        NA -1.0497954 -0.4427657 -0.57543361 -0.31050097      NA ##         S_02       S_03      S_04        S_05       S_06       S_07       S_08 ## 1         NA         NA        NA -0.42961520  0.1019106  0.3944213 -0.7471462 ## 2         NA         NA        NA -0.37916148 -0.4258262 -0.3930587 -0.8900900 ## 3         NA         NA        NA -0.82186420 -0.4086093 -0.5548583 -0.8992825 ## 4 -0.9010645 -0.4331578 -1.252771 -0.31265712 -0.4093047 -0.5465060 -0.4536835 ## 5         NA         NA        NA -0.04835898 -0.6610427 -0.6116665 -0.7012145 ## 6         NA         NA        NA -0.40651275 -0.5312910 -0.8688640 -0.7859765 ##         S_09 ## 1  0.4104976 ## 2 -0.4564657 ## 3 -0.5314916 ## 4 -0.6120104 ## 5 -0.5859379 ## 6 -0.4081825"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"data-source","dir":"Articles","previous_headings":"","what":"Data source","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"vignette demonstrates processing usign PNNL’s DMS data source. PNNL DMS based MS SQL Server. Typically data organized data packages according experiments. Data package contains phospho data mirroring PlexedPiperTestData number 3626. Smaller version data package, suggested testing purposes 3625.","code":"data_package_num <- 3625 # if there is no connection to PNNL DMS, vignette is not compiled if(!is_PNNL_DMS_connection_successful()){    message(\"There is no connection to PNNL DMS. This code in this vignette won't be evaluated.\")    knitr::opts_chunk$set(eval = FALSE) }"},{"path":[]},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"read-the-ms-gf-output","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Read the MS-GF+ output","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"First step determine MS-GF+ jobs using data package number. simply reads parsed text output MS-GF+ search engine. text files collated together resulting data.frame used create MSnID object.","code":"msnid <- read_msgf_data_from_DMS(data_package_num) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 101202 at 61 % FDR ## #peptides: 76398 at 75 % FDR ## #accessions: 78483 at 94 % FDR"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"ascore","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"AScore","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"Phospho dataset involve Ascore jobs improving phospho-site localization. one Ascore job per data package. fetched object data.frame links datasets, scans original PTM localization newly suggested locations. Importantly contains AScore column signifies confidence PTM assingment. AScore > 17 considered confident. Remove non-phospho. Need sure phospho symbol *!","code":"ascore <- get_AScore_results(data_package_num) msnid <- best_PTM_location_by_ascore(msnid, ascore) msnid <- apply_filter(msnid, \"grepl(\\\"\\\\\\\\*\\\", peptide)\")"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"fdr-filter","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"FDR filter","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"FDR filter peptide level.","code":"msnid <- filter_msgf_data_peptide_level(msnid, 0.01)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"inference-of-parsimonius-set","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Inference of parsimonius set","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"","code":"msnid <- infer_parsimonious_accessions(msnid)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"mapping-sites-to-protein-sequence","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Mapping sites to protein sequence","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"Mapping sites protein sequence. Call creates number columns describing mapping site/s onto protein sequences. important user SiteID. Prepare FASTA make sure entry names FASTA file match MSnID accessions. plan make conversion automatic. Note, type ID extraction ignore non-RefSeq entries contaminants. Mapping main call.","code":"fst_dms_pth <- path_to_FASTA_used_by_DMS(data_package_num) fst <- readAAStringSet(fst_dms_pth) names(fst) <- gsub(\" .*\", \"\", names(fst)) # make names match accessions msnid <- map_mod_sites(msnid, fst,                         accession_col = \"accession\",                         peptide_mod_col = \"peptide\",                         mod_char = \"*\",                        site_delimiter = \"lower\") head(psms(msnid)) ##                                                 Dataset ResultID  Scan ## 1 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      408 32861 ## 2 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      414 31457 ## 3 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      636 33482 ## 4 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      641 33163 ## 5 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      664 33807 ## 6 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      701 34776 ##   FragMethod SpecIndex Charge PrecursorMZ     DelM DelM_PPM      MH ## 1        HCD        86      3    991.8065 -0.00530  -1.7846 2973.41 ## 2        HCD        88      3    991.8090  0.00201   0.6769 2973.41 ## 3        HCD       119      3    992.1422 -0.00158  -0.5326 2973.41 ## 4        HCD       123      3    992.1429  0.00043   0.1443 2973.41 ## 5        HCD       132      3    992.1419 -0.00250  -0.8403 2973.41 ## 6        HCD       145      3    992.4756 -0.00463  -1.5576 2973.41 ##               OriginalPeptide     Protein NTT DeNovoScore MSGFScore ## 1 R.AAAEGSS*NVFSMFDQTQIQEFK.E NP_036737.1   2         144       114 ## 2 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         124       108 ## 3 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         134       112 ## 4 R.AAAEGSS*NVFSMFDQTQIQEFK.E NP_036737.1   2         136       110 ## 5 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         133       101 ## 6 R.AAAEGSSNVFS*MFDQTQIQEFK.E NP_036737.1   2         123       104 ##   MSGFDB_SpecEValue Rank_MSGFDB_SpecEValue     EValue QValue PepQValue ## 1        1.3776e-17                      1 3.5033e-10      0         0 ## 2        1.5700e-17                      1 3.9924e-10      0         0 ## 3        3.9576e-17                      1 1.0064e-09      0         0 ## 4        4.4128e-17                      1 1.1222e-09      0         0 ## 5        7.3846e-17                      1 1.8779e-09      0         0 ## 6        1.3331e-16                      1 3.3901e-09      0         0 ##   IsotopeError   accession calculatedMassToCharge chargeState ## 1            0 NP_036737.1               991.8083           3 ## 2            0 NP_036737.1               991.8083           3 ## 3            1 NP_036737.1               991.8083           3 ## 4            1 NP_036737.1               991.8083           3 ## 5            1 NP_036737.1               991.8083           3 ## 6            2 NP_036737.1               991.8083           3 ##   experimentalMassToCharge isDecoy ## 1                 991.8065   FALSE ## 2                 991.8090   FALSE ## 3                 992.1422   FALSE ## 4                 992.1429   FALSE ## 5                 992.1419   FALSE ## 6                 992.4756   FALSE ##                                            spectrumFile spectrumID ## 1 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      32861 ## 2 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      31457 ## 3 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      33482 ## 4 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      33163 ## 5 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      33807 ## 6 MoTrPAC_Pilot_TMT_P_S1_01_DIL_28Oct17_Elm_AQ-17-10-03      34776 ##                   pepSeq                     peptide maxAScore msmsScore ## 1 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 2 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    18.255       Inf ## 3 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 4 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 5 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ## 6 AAAEGSSNVFSMFDQTQIQEFK R.AAAEGSS*NVFSMFDQTQIQEFK.E    17.468       Inf ##   absParentMassErrorPPM First_AA Last_AA First_AA_First Last_AA_First ProtLen ## 1             1.7627512       10      31             10            31     169 ## 2             0.6974017       10      31             10            31     169 ## 3           336.6998436       10      31             10            31     169 ## 4           337.3753774       10      31             10            31     169 ## 5           336.3973658       10      31             10            31     169 ## 6           672.8938547       10      31             10            31     169 ##   ModShift ModAAs SiteLoc Site SiteCollapsed SiteCollapsedFirst ## 1        6      S      16  S16           S16                S16 ## 2        6      S      16  S16           S16                S16 ## 3        6      S      16  S16           S16                S16 ## 4        6      S      16  S16           S16                S16 ## 5        6      S      16  S16           S16                S16 ## 6        6      S      16  S16           S16                S16 ##             SiteID ## 1 NP_036737.1-S16s ## 2 NP_036737.1-S16s ## 3 NP_036737.1-S16s ## 4 NP_036737.1-S16s ## 5 NP_036737.1-S16s ## 6 NP_036737.1-S16s"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"prepare-masic-reporter-ion-intensities","dir":"Articles","previous_headings":"","what":"Prepare MASIC reporter ion intensities","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"Fetching preparing reporter intensities based MASIC ouput.","code":"masic_data <- read_masic_data_from_DMS(data_package_num,                                         interference_score = T) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% masic_data <- filter_masic_data(masic_data, 0.5, 0)"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"fetch-study-design-tables","dir":"Articles","previous_headings":"","what":"Fetch study design tables","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"","code":"study_design_tables <- get_study_design_by_dataset_package(data_package_num) fractions <- study_design_tables$fractions samples <- study_design_tables$samples references <- study_design_tables$references"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"create-cross-tab","dir":"Articles","previous_headings":"","what":"Create cross-tab","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"Aggregation RefSeq / peptide level.","code":"msnid <- apply_filter(msnid, \"!isDecoy\") # aggregation_level <- c(\"SiteID\") aggregation_level <- c(\"accession\",\"peptide\") quant_cross_tab <- create_crosstab(msnid,                                     masic_data,                                     aggregation_level,                                     fractions, samples, references) dim(quant_cross_tab) ## [1] 3147   18 head(quant_cross_tab) ##                                               R_01       R_02       R_03 ## NP_001001514.1@R.TSSPSSAGSVSLGHYT*PTSR.S        NA         NA         NA ## NP_001002016.2@R.SVGGS*GGGSFGDNLVTR.S           NA         NA         NA ## NP_001002022.1@K.DREDSPERCS*DSDEEK.K            NA         NA         NA ## NP_001002277.1@K.ERS*PPLTPK.E            -0.221334 -0.2668764 -0.4962683 ## NP_001002823.2@K.S*VIGTPEFMAPEMYEEK.Y           NA         NA         NA ## NP_001002823.2@K.SIS*NPPGSNLR.T                 NA         NA         NA ##                                                R_04      R_05       R_06 ## NP_001001514.1@R.TSSPSSAGSVSLGHYT*PTSR.S         NA        NA -0.9102728 ## NP_001002016.2@R.SVGGS*GGGSFGDNLVTR.S            NA        NA -0.8376728 ## NP_001002022.1@K.DREDSPERCS*DSDEEK.K             NA        NA -0.3585890 ## NP_001002277.1@K.ERS*PPLTPK.E            -0.6486341 -0.502687 -0.7197738 ## NP_001002823.2@K.S*VIGTPEFMAPEMYEEK.Y            NA        NA -1.0497954 ## NP_001002823.2@K.SIS*NPPGSNLR.T                  NA        NA -0.9991695 ##                                                R_07        R_08        R_09 ## NP_001001514.1@R.TSSPSSAGSVSLGHYT*PTSR.S  0.1452157  0.29764868  1.06356080 ## NP_001002016.2@R.SVGGS*GGGSFGDNLVTR.S    -0.1266532 -0.47675809 -0.16171559 ## NP_001002022.1@K.DREDSPERCS*DSDEEK.K     -1.1223969 -0.08709753  0.01915121 ## NP_001002277.1@K.ERS*PPLTPK.E            -0.4621769 -0.57432542 -0.08255740 ## NP_001002823.2@K.S*VIGTPEFMAPEMYEEK.Y    -0.4427657 -0.57543361 -0.31050097 ## NP_001002823.2@K.SIS*NPPGSNLR.T          -0.6964205 -0.69518658 -0.19798040 ##                                             S_01       S_02       S_03 ## NP_001001514.1@R.TSSPSSAGSVSLGHYT*PTSR.S      NA         NA         NA ## NP_001002016.2@R.SVGGS*GGGSFGDNLVTR.S         NA         NA         NA ## NP_001002022.1@K.DREDSPERCS*DSDEEK.K          NA         NA         NA ## NP_001002277.1@K.ERS*PPLTPK.E            -1.1161 -0.9010645 -0.4331578 ## NP_001002823.2@K.S*VIGTPEFMAPEMYEEK.Y         NA         NA         NA ## NP_001002823.2@K.SIS*NPPGSNLR.T               NA         NA         NA ##                                               S_04        S_05       S_06 ## NP_001001514.1@R.TSSPSSAGSVSLGHYT*PTSR.S        NA -0.42961520  0.1019106 ## NP_001002016.2@R.SVGGS*GGGSFGDNLVTR.S           NA -0.37916148 -0.4258262 ## NP_001002022.1@K.DREDSPERCS*DSDEEK.K            NA -0.82186420 -0.4086093 ## NP_001002277.1@K.ERS*PPLTPK.E            -1.252771 -0.31265712 -0.4093047 ## NP_001002823.2@K.S*VIGTPEFMAPEMYEEK.Y           NA -0.40651275 -0.5312910 ## NP_001002823.2@K.SIS*NPPGSNLR.T                 NA -0.04835898 -0.6610427 ##                                                S_07       S_08       S_09 ## NP_001001514.1@R.TSSPSSAGSVSLGHYT*PTSR.S  0.3944213 -0.7471462  0.4104976 ## NP_001002016.2@R.SVGGS*GGGSFGDNLVTR.S    -0.3930587 -0.8900900 -0.4564657 ## NP_001002022.1@K.DREDSPERCS*DSDEEK.K     -0.5548583 -0.8992825 -0.5314916 ## NP_001002277.1@K.ERS*PPLTPK.E            -0.5465060 -0.4536835 -0.6120104 ## NP_001002823.2@K.S*VIGTPEFMAPEMYEEK.Y    -0.8688640 -0.7859765 -0.4081825 ## NP_001002823.2@K.SIS*NPPGSNLR.T          -0.6116665 -0.7012145 -0.5859379"},{"path":"/articles/tmt_pipeline_for_PNNL_DMS_phos_pep_MoTrPAC.html","id":"post-processing--linking-with-ascores","dir":"Articles","previous_headings":"","what":"Post-processing. Linking with AScores","title":"Suggested TMT processing pipeline for PNNL DMS *phospho* data\nfor MoTrPAC project. Peptide level.\n","text":"","code":"x_ascore <-    psms(msnid) %>%    group_by(accession, peptide, SiteID) %>%   summarise(maxAScore = max(maxAScore))  x <- quant_cross_tab %>%   as.data.frame() %>%   tibble::rownames_to_column(\"ID\") %>%   mutate(RefSeq =  sub(\"(.*)@(.\\\\..*\\\\..)\",\"\\\\1\",ID),          peptide = sub(\"(.*)@(.\\\\..*\\\\..)\",\"\\\\2\",ID)) %>%   dplyr::select(-ID) %>%   inner_join(x_ascore) %>%   mutate(ConfidentSite = maxAScore > 17,          peptide = gsub(\".\\\\.(.*)\\\\..\",\"\\\\1\",peptide, perl=T),          peptide = gsub(\"(\\\\w)\\\\*\",\"\\\\L\\\\1\",peptide, perl=T),          SiteID = sub(\"-\", \"_\", SiteID),          ptm_peptide = paste0(SiteID, \"-\", peptide))  %>%   dplyr::rename(ptm_id = SiteID,                 ascore = maxAScore,                 confidence = ConfidentSite) %>%   dplyr::select(-c(accession, RefSeq)) %>%   dplyr::select(ptm_peptide, ptm_id, peptide, ascore, confidence, everything()) head(x) ##                                 ptm_peptide                ptm_id ## 1 NP_001001514.1_T378t-TSSPSSAGSVSLGHYtPTSR  NP_001001514.1_T378t ## 2    NP_001002016.2_S633s-SVGGsGGGSFGDNLVTR  NP_001002016.2_S633s ## 3     NP_001002022.1_S232s-DREDSPERCsDSDEEK  NP_001002022.1_S232s ## 4            NP_001002277.1_S975s-ERsPPLTPK  NP_001002277.1_S975s ## 5    NP_001002823.2_S382s-sVIGTPEFMAPEMYEEK  NP_001002823.2_S382s ## 6         NP_001002823.2_S2624s-SIsNPPGSNLR NP_001002823.2_S2624s ##                peptide ascore confidence      R_01       R_02       R_03 ## 1 TSSPSSAGSVSLGHYtPTSR 17.980       TRUE        NA         NA         NA ## 2    SVGGsGGGSFGDNLVTR 58.252       TRUE        NA         NA         NA ## 3     DREDSPERCsDSDEEK  0.000      FALSE        NA         NA         NA ## 4            ERsPPLTPK 98.625       TRUE -0.221334 -0.2668764 -0.4962683 ## 5    sVIGTPEFMAPEMYEEK 52.139       TRUE        NA         NA         NA ## 6          SIsNPPGSNLR 34.792       TRUE        NA         NA         NA ##         R_04      R_05       R_06       R_07        R_08        R_09    S_01 ## 1         NA        NA -0.9102728  0.1452157  0.29764868  1.06356080      NA ## 2         NA        NA -0.8376728 -0.1266532 -0.47675809 -0.16171559      NA ## 3         NA        NA -0.3585890 -1.1223969 -0.08709753  0.01915121      NA ## 4 -0.6486341 -0.502687 -0.7197738 -0.4621769 -0.57432542 -0.08255740 -1.1161 ## 5         NA        NA -1.0497954 -0.4427657 -0.57543361 -0.31050097      NA ## 6         NA        NA -0.9991695 -0.6964205 -0.69518658 -0.19798040      NA ##         S_02       S_03      S_04        S_05       S_06       S_07       S_08 ## 1         NA         NA        NA -0.42961520  0.1019106  0.3944213 -0.7471462 ## 2         NA         NA        NA -0.37916148 -0.4258262 -0.3930587 -0.8900900 ## 3         NA         NA        NA -0.82186420 -0.4086093 -0.5548583 -0.8992825 ## 4 -0.9010645 -0.4331578 -1.252771 -0.31265712 -0.4093047 -0.5465060 -0.4536835 ## 5         NA         NA        NA -0.40651275 -0.5312910 -0.8688640 -0.7859765 ## 6         NA         NA        NA -0.04835898 -0.6610427 -0.6116665 -0.7012145 ##         S_09 ## 1  0.4104976 ## 2 -0.4564657 ## 3 -0.5314916 ## 4 -0.6120104 ## 5 -0.4081825 ## 6 -0.5859379"},{"path":"/articles/tmt_pipeline_v1.html","id":"data-source","dir":"Articles","previous_headings":"","what":"Data source","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"pipeline shows process TMT data processed outside PNNL DMS. implies raw files processed MSGF+ MASIC tools processing results corresponding directories. convienience results MSGF+ MASIC processing provided companion PlexedPiperTestData package.","code":""},{"path":[]},{"path":"/articles/tmt_pipeline_v1.html","id":"read-the-ms-gf-output","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Read the MS-GF+ output","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"simply reads parsed text output MS-GF+ search engine. text files collated together resulting data.frame used create MSnID object. MSnID methods corrects isotope selection error. Occasionally, instrument selects lightest monoisotopic peak, peak +1 C13. MS-GF+ still capable correctly identifying , downstream calculations mass measurement error need fixed. method corrects mass measurement errors accounting selection monoisotopic peak.","code":"path_to_MSGF_results <- system.file(    \"extdata/global/msgf_output\",    package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  48  ## #PSMs: 1156754 at 31 % FDR ## #peptides: 511617 at 61 % FDR ## #accessions: 128378 at 98 % FDR msnid <- correct_peak_selection(msnid)"},{"path":"/articles/tmt_pipeline_v1.html","id":"msms-id-filter-and-peptide-level","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"MS/MS ID filter and peptide level","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"Main MS/MS filtering step. filter_msgf_data_peptide_level function wraps-MSnID::optimize_filter method uses PepQValue MS-GF+ output absolute deviation mass measurement error parent ions (ppm).","code":"show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  48  ## #PSMs: 1156754 at 31 % FDR ## #peptides: 511617 at 61 % FDR ## #accessions: 128378 at 98 % FDR msnid <- filter_msgf_data_peptide_level(msnid, 0.01) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  48  ## #PSMs: 480204 at 0.45 % FDR ## #peptides: 96637 at 1 % FDR ## #accessions: 26926 at 8.7 % FDR"},{"path":"/articles/tmt_pipeline_v1.html","id":"switching-annotation-from-refseq-to-gene-symbols","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Switching annotation from RefSeq to gene symbols","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"RefSeq gene symbols conversion step can skipped downstream analysis relies RefSeq IDs. RefSeq redundant database contains lots tentative splice isoforms unconfirmed ORFs. result, lot peptides (~60%) shared across multiple RefSeq accessions. adds uncertainity exactly protein quantifying. One solution switch less redundant annotations like gene symbol. Moreover gene symbols human-interpretable quite commonly used downstream analysis. step converts sequences names fasta file used MS/MS searches RefSeq gene symbols. necessary going count number peptide identifications per protein protein sequence coverage accessions switched RefSeq gene symbols.","code":"msnid <- remap_accessions_refseq_to_gene(msnid,                                           organism_name=\"Rattus norvegicus\") path_to_FASTA <- system.file(    \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",    package = \"PlexedPiperTestData\") temp_dir <- tempdir() file.copy(path_to_FASTA, temp_dir) ## [1] TRUE path_to_FASTA <- file.path(temp_dir, basename(path_to_FASTA)) path_to_FASTA_gene <- remap_accessions_refseq_to_gene_fasta(    path_to_FASTA, organism_name=\"Rattus norvegicus\")"},{"path":"/articles/tmt_pipeline_v1.html","id":"msms-id-filter-at-protein-level","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"MS/MS ID filter at protein level","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"ago proteomics field established hard--fast two peptide per protein rule. protein identified one peptide considered confident identification. works OK, room improvement. example rule really penalizes short protens. long proteins (e.g. Titin 3.8 MDa) easily two matching peptides even reversed sequence. Thus, propose normalize number peptides per protein length use filtering criterion.","code":"msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA_gene) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  48  ## #PSMs: 480204 at 0.45 % FDR ## #peptides: 96637 at 1 % FDR ## #accessions: 8152 at 7 % FDR msnid <- filter_msgf_data_protein_level(msnid, 0.01) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  48  ## #PSMs: 398451 at 0.2 % FDR ## #peptides: 81356 at 0.35 % FDR ## #accessions: 5377 at 1 % FDR"},{"path":"/articles/tmt_pipeline_v1.html","id":"inference-of-parsimonious-protein-set","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Inference of parsimonious protein set","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"situation sequence certain peptide matches multiple proteins adds complication downstream quantitative analysis clear protein product peptide originating . common ways selecting protein set. One simply retain uniquely matching peptides (unique_only=TRUE). Shared peptides simply discarded case. Alternatively (case unique_only=FALSE) shared peptides assigned proteins larger number uniquely mapping peptides. choice multiple proteins equal number uniquely mapping peptides, shared peptides assigned first protein according alphanumeric order.","code":"msnid <- infer_parsimonious_accessions(msnid, unique_only=TRUE) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  48  ## #PSMs: 301910 at 0.23 % FDR ## #peptides: 72937 at 0.34 % FDR ## #accessions: 4820 at 0.96 % FDR"},{"path":"/articles/tmt_pipeline_v1.html","id":"remove-decoy-accessions","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Remove decoy accessions","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"","code":"msnid <- apply_filter(msnid, \"!isDecoy\")"},{"path":[]},{"path":"/articles/tmt_pipeline_v1.html","id":"read-masic-ouput","dir":"Articles","previous_headings":"Prepare reporter ion intensities","what":"Read MASIC ouput","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"MASIC tool extracting ion intensities. proper parameter settings can used extracting TMT (iTRAQ) reporter ion intensities. addition reporter number helpful metrics. interest interference score parent ion level S/N reporter ion level. Interference score reflects proportion ion population isolated fragmentation due targeted ion. words 1 - InterferenceScore due co-isolated species similar elution time parent ion m/z. S/N reporter level metric computed Thermo software.","code":"path_to_MASIC_results <- system.file(\"extdata/global/masic_output\", package = \"PlexedPiperTestData\") masic_data <- read_masic_data(path_to_MASIC_results, interference_score=TRUE) head(masic_data) ##                                             Dataset ScanNumber Collision.Mode ## 1 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          2            hcd ## 2 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          3            hcd ## 3 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          4            hcd ## 4 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          5            hcd ## 5 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          6            hcd ## 6 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          8            hcd ##   ParentIonMZ BasePeakIntensity BasePeakMZ ReporterIonIntensityMax Ion_126.128 ## 1      407.74         227695.44   407.7408                92236.87    70562.39 ## 2      396.72          59127.97   529.2943                34294.90    23706.89 ## 3      438.23         110444.82   362.2239                14053.40    12459.86 ## 4      481.50          37082.72   206.4663                    0.00        0.00 ## 5      549.28          21077.05   128.1285                21077.05        0.00 ## 6      388.72          40605.85   356.7193                 8087.76     6166.82 ##   Ion_127.125 Ion_127.131 Ion_128.128 Ion_128.134 Ion_129.131 Ion_129.138 ## 1    24864.62    17165.80    35625.00    92236.87     9640.23     8578.05 ## 2    13559.32     5856.83    16322.71    34294.90     4853.11     7938.24 ## 3    11785.91    10932.51    10653.32    12328.62     5959.86     9905.82 ## 4        0.00        0.00        0.00        0.00        0.00        0.00 ## 5    10998.67        0.00    21077.05     2725.50        0.00        0.00 ## 6     1371.27     2418.35     8087.76     5485.35        0.00        0.00 ##   Ion_130.135 Ion_130.141 Ion_131.138 Weighted.Avg.Pct.Intensity.Correction ## 1     6996.69    11833.07    32281.34                                     0 ## 2        0.00     1465.03    18182.27                                     0 ## 3     8387.04    11166.70    14053.40                                     0 ## 4        0.00        0.00        0.00                                     0 ## 5        0.00        0.00     6800.70                                     0 ## 6     1543.48     1943.96     7436.60                                     0 ##   Ion_126.128_SignalToNoise Ion_127.125_SignalToNoise Ion_127.131_SignalToNoise ## 1                     71.47                     25.17                     17.38 ## 2                     26.12                     14.94                      6.45 ## 3                     12.40                     11.75                     10.90 ## 4                        NA                        NA                        NA ## 5                        NA                      9.19                        NA ## 6                      6.92                      1.54                      2.71 ##   Ion_128.128_SignalToNoise Ion_128.134_SignalToNoise Ion_129.131_SignalToNoise ## 1                     36.04                     93.32                      9.75 ## 2                     17.97                     37.77                      5.34 ## 3                     10.64                     12.31                      5.96 ## 4                        NA                        NA                        NA ## 5                     17.57                      2.27                        NA ## 6                      9.04                      6.13                        NA ##   Ion_129.138_SignalToNoise Ion_130.135_SignalToNoise Ion_130.141_SignalToNoise ## 1                      8.67                      7.07                     11.96 ## 2                      8.74                        NA                      1.61 ## 3                      9.91                      8.40                     11.18 ## 4                        NA                        NA                        NA ## 5                        NA                        NA                        NA ## 6                        NA                      1.72                      2.16 ##   Ion_131.138_SignalToNoise Ion_126.128_Resolution Ion_127.125_Resolution ## 1                     32.71                  44102                  42700 ## 2                     19.93                  42702                  41100 ## 3                     14.13                  42006                  40702 ## 4                        NA                     NA                     NA ## 5                      5.66                     NA                  40302 ## 6                      8.26                  40000                  26400 ##   Ion_127.131_Resolution Ion_128.128_Resolution Ion_128.134_Resolution ## 1                  42100                  41800                  44404 ## 2                  37000                  40400                  43404 ## 3                  41402                  40700                  40400 ## 4                     NA                     NA                     NA ## 5                     NA                  42102                  46600 ## 6                  30400                  40400                  44300 ##   Ion_129.131_Resolution Ion_129.138_Resolution Ion_130.135_Resolution ## 1                  40500                  39500                  36800 ## 2                  36400                  39700                     NA ## 3                  38800                  40200                  38900 ## 4                     NA                     NA                     NA ## 5                     NA                     NA                     NA ## 6                     NA                     NA                  28800 ##   Ion_130.141_Resolution Ion_131.138_Resolution ParentIonIndex       MZ ## 1                  41100                  42302              0 407.7424 ## 2                  29800                  41802              1 396.7176 ## 3                  40400                  41002              2 438.2270 ## 4                     NA                     NA              3 481.5049 ## 5                     NA                  40300              4 549.2793 ## 6                  28500                  38700              5 388.7199 ##   SurveyScanNumber OptimalPeakApexScanNumber PeakApexOverrideParentIonIndex ## 1                1                        12                             -1 ## 2                1                        12                             -1 ## 3                1                       131                             18 ## 4                1                        23                             -1 ## 5                1                        15                             -1 ## 6                7                        12                             -1 ##   CustomSICPeak PeakScanStart PeakScanEnd PeakScanMaxIntensity PeakMaxIntensity ## 1             0             1          19                   12          2901600 ## 2             0             1          19                   12          2181900 ## 3             0             1         114                  107          8255600 ## 4             0             1          52                   23           401824 ## 5             0             1          16                   15           363656 ## 6             0             1          30                   12           478135 ##   PeakSignalToNoiseRatio FWHMInScans  PeakArea ParentIonIntensity ## 1               211.0000           5  50422000            2579600 ## 2                19.6900           5  34508000            1690600 ## 3                 9.4650          44 444610000             658727 ## 4                27.9900          23  16244000             344491 ## 5                 0.6998           5   5941200             347071 ## 6                28.7100          19  10718000             291189 ##   PeakBaselineNoiseLevel PeakBaselineNoiseStDev PeakBaselinePointsUsed ## 1                  13750                  97562                  10113 ## 2                 110841                1120000                  10166 ## 3                 872195                2620000                  10129 ## 4                  14356                  65777                  10109 ## 5                 519640                1990000                  10109 ## 6                  16653                 142562                  10142 ##   StatMomentsArea CenterOfMassScan PeakStDev PeakSkew PeakKSStat ## 1        47031000               11      5.68 -0.18920     0.3528 ## 2        31578000               11      5.59 -0.21720     0.3469 ## 3       343470000               82     22.80 -0.62610     1.0990 ## 4        14899000               26     14.10  0.05387     0.5036 ## 5         2528900               15      2.49 -0.58330     0.4302 ## 6         9961100               16      8.60 -0.05055     0.2833 ##   StatMomentsDataCountUsed InterferenceScore ## 1                       10            0.9961 ## 2                       10            0.9925 ## 3                       89            1.0000 ## 4                       39            1.0000 ## 5                        5            1.0000 ## 6                       18            0.9688"},{"path":"/articles/tmt_pipeline_v1.html","id":"filtering-masic-data","dir":"Articles","previous_headings":"Prepare reporter ion intensities","what":"Filtering MASIC data","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"case (currently recommended filters) require least 50% ion population due targeted ion filter S/N level.","code":"nrow(masic_data) ## [1] 1598123 masic_data <- filter_masic_data(masic_data, 0.5, 0) nrow(masic_data) ## [1] 1523732"},{"path":[]},{"path":"/articles/tmt_pipeline_v1.html","id":"laying-out-study-desing","dir":"Articles","previous_headings":"Creating cross-tab","what":"Laying out study desing","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"convert PSMs reporter ion intensities meaningful quantitative data necessary know samples reporter channels intended reference channel (combination channels). entire study desing captured three tables - fractions, samples, references.","code":""},{"path":"/articles/tmt_pipeline_v1.html","id":"fractions","dir":"Articles","previous_headings":"Creating cross-tab","what":"Fractions","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"links dataset original plex.","code":"library(readr) fractions <- read_tsv(system.file(\"extdata/study_design/fractions.txt\", package = \"PlexedPiperTestData\")) head(fractions) ## # A tibble: 6 x 2 ##   Dataset                                           PlexID ##   <chr>                                             <chr>  ## 1 MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02 S1     ## 2 MoTrPAC_Pilot_TMT_W_S1_02_12Oct17_Elm_AQ-17-09-02 S1     ## 3 MoTrPAC_Pilot_TMT_W_S1_05_12Oct17_Elm_AQ-17-09-02 S1     ## 4 MoTrPAC_Pilot_TMT_W_S1_03_12Oct17_Elm_AQ-17-09-02 S1     ## 5 MoTrPAC_Pilot_TMT_W_S1_04_12Oct17_Elm_AQ-17-09-02 S1     ## 6 MoTrPAC_Pilot_TMT_W_S1_06_12Oct17_Elm_AQ-17-09-02 S1"},{"path":"/articles/tmt_pipeline_v1.html","id":"samples","dir":"Articles","previous_headings":"Creating cross-tab","what":"Samples","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"links plex ID, reporter channel samples. minor difference ReporterAlias MeasurementName. MeasurementName sample name finally reported. ReporterAlias itermediate ReporterName MeasurementName used defining reference .","code":"samples <- read_tsv(system.file(\"extdata/study_design/samples.txt\", package = \"PlexedPiperTestData\")) head(samples,10) ## # A tibble: 10 x 5 ##    PlexID QuantBlock ReporterName ReporterAlias MeasurementName ##    <chr>       <dbl> <chr>        <chr>         <chr>           ##  1 S1              1 126          R_01          R_01            ##  2 S1              1 127N         R_03          R_03            ##  3 S1              1 127C         R_02          R_02            ##  4 S1              1 128N         R_05          R_05            ##  5 S1              1 128C         R_04          R_04            ##  6 S1              1 129N         S_02          S_02            ##  7 S1              1 129C         S_01          S_01            ##  8 S1              1 130N         S_04          S_04            ##  9 S1              1 130C         S_03          S_03            ## 10 S1              1 131          ref           NA"},{"path":"/articles/tmt_pipeline_v1.html","id":"references","dir":"Articles","previous_headings":"Creating cross-tab","what":"References","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"Reference can certain channel, average multiple channels 1. general form expression ReporterAlias names variables. evaluated PlexID/QuantBlock combination applied divide reporter ion intensities within corresponding PlexID/QuantBlock. QuantBlock can though way defining sub-plex. typical TMT experiment QuantBlock always 1. case 5 pairwise comparisons within TMT10, 5 QuantBlocks (1..5) reference QuantBlock.","code":"references <- read_tsv(system.file(\"extdata/study_design/references.txt\", package = \"PlexedPiperTestData\")) head(references) ## # A tibble: 2 x 3 ##   PlexID QuantBlock Reference ##   <chr>       <dbl> <chr>     ## 1 S1              1 ref       ## 2 S2              1 ref"},{"path":"/articles/tmt_pipeline_v1.html","id":"creating-quantitative-cross-tab","dir":"Articles","previous_headings":"Creating cross-tab","what":"Creating quantitative cross-tab","title":"Suggested TMT processing pipeline. Variant 1.\n","text":"Final step MS/MS IDs reporter ions linked together, aggregated peptide accession (.e. protein) level. retain protein IDs aggregating peptide level suggest aggregation_level <- c(\"accession\",\"peptide\")","code":"aggregation_level <- c(\"accession\") quant_cross_tab <- create_crosstab(msnid,                                     masic_data,                                     aggregation_level,                                     fractions, samples, references) dim(quant_cross_tab) ## [1] 4762   18 head(quant_cross_tab) ##              R_01        R_02       R_03         R_04       R_05       R_06 ## ATP8  -0.19479833 -0.40351693 -0.7899082 -0.207686309 -0.5735321 -0.6217460 ## Aagab -0.33114648 -0.09698122 -0.4610205 -0.204455063 -0.3674259 -0.9622379 ## Aak1  -0.12524883 -0.04935325 -0.3961333  0.006220386 -0.1831229 -0.8278655 ## Aamdc -0.18262236 -0.14712884 -0.4295235 -0.338216384 -0.5193325 -0.7662433 ## Aamp   0.01319057 -0.05586270 -0.4874643 -0.176035341 -0.2877920 -0.9128142 ## Aar2  -0.28239827 -0.05731137 -0.4382888 -0.312729380 -0.5601654 -0.7180116 ##             R_07       R_08         R_09        S_01       S_02       S_03 ## ATP8  -0.6862703 -0.3539212 -0.239588729 -1.23906148 -1.0119484 -0.7436739 ## Aagab -0.8219094 -0.6039567 -0.349913889 -0.16655998 -1.0566135 -0.6460940 ## Aak1  -0.5477375 -0.4730509  0.032356743 -0.02601848 -0.7284031 -0.5183336 ## Aamdc -0.6260984 -0.4093530 -0.004382412 -0.18326078 -0.8802873 -0.5951816 ## Aamp  -0.7298059 -0.5725573 -0.127739120  0.03925511 -0.5639567 -0.5788605 ## Aar2  -0.6492230 -0.3802387 -0.033934887 -0.27326401 -0.8040756 -0.5338878 ##             S_04        S_05       S_06       S_07       S_08       S_09 ## ATP8  -0.8203905  0.18483797 -0.1652751 -0.3545360 -0.6421465 -0.4344390 ## Aagab -0.9723428 -0.72798837 -0.7156128 -0.1366306 -1.0352613 -0.6912676 ## Aak1  -1.0432754 -0.19864328 -0.3533702 -0.3482648 -0.5589898 -0.5497933 ## Aamdc -0.9138052 -0.19684213 -0.2303194 -0.2628076 -0.7913746 -0.5035342 ## Aamp  -0.9582277 -0.28850123 -0.3668970 -0.5391545 -0.8578482 -0.5955917 ## Aar2  -0.9288846 -0.01109715 -0.3226456 -0.2250253 -0.7562436 -0.4057189"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"data-source","dir":"Articles","previous_headings":"","what":"Data source","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"pipeline shows process TMT data processed within PNNL DMS. Data PNNL DMS organized using MS SQL Server data packages. data package number matching PlexedPiperTestData 3442. Note, vignette won’t compile now access PNNL DMS. Alternative, smaller variant 3442 package 3606.","code":"data_package_num <- 3606 # if there is no connection to PNNL DMS, vignette is not compiled if(!is_PNNL_DMS_connection_successful()){    message(\"There is no connection to PNNL DMS. This code in this vignette won't be evaluated.\")    knitr::opts_chunk$set(eval = FALSE) }"},{"path":[]},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"read-the-ms-gf-output","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Read the MS-GF+ output","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"Fetching MS/MS search results data package number. text files collated together resulting data.frame used create MSnID object. MSnID methods corrects isotope selection error. Occasionally, instrument selects lightest monoisotopic peak, peak +1 C13. MS-GF+ still capable correctly identifying , downstream calculations mass measurement error need fixed. method corrects mass measurement errors accounting selection monoisotopic peak.","code":"msnid <- read_msgf_data_from_DMS(data_package_num) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 96612 at 30 % FDR ## #peptides: 53098 at 54 % FDR ## #accessions: 72917 at 84 % FDR msnid <- correct_peak_selection(msnid)"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"msms-id-filter-and-peptide-level","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"MS/MS ID filter and peptide level","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"Main MS/MS filtering step. filter_msgf_data_peptide_level function wraps-MSnID::optimize_filter method uses PepQValue MS-GF+ output absolute deviation mass measurement error parent ions (ppm).","code":"show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 96612 at 30 % FDR ## #peptides: 53098 at 54 % FDR ## #accessions: 72917 at 84 % FDR msnid <- filter_msgf_data_peptide_level(msnid, 0.01) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 41743 at 0.74 % FDR ## #peptides: 12201 at 0.99 % FDR ## #accessions: 12255 at 3.6 % FDR"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"switching-annotation-from-refseq-to-gene-symbols","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Switching annotation from RefSeq to gene symbols","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"RefSeq gene symbols conversion step can skipped downstream analysis relies RefSeq IDs. RefSeq redundant database contains lots tentative splice isoforms unconfirmed ORFs. result, lot peptides (~60%) shared across multiple RefSeq accessions. adds uncertainity exactly protein quantifying. One solution switch less redundant annotations like gene symbol. Moreover gene symbols human-interpretable quite commonly used downstream analysis. step converts sequences names fasta file used MS/MS searches RefSeq gene symbols. necessary going count number peptide identifications per protein protein sequence coverage accessions switched RefSeq gene symbols.","code":"msnid <- remap_accessions_refseq_to_gene(msnid,                                           organism_name=\"Rattus norvegicus\") path_to_FASTA <- path_to_FASTA_used_by_DMS(data_package_num) path_to_FASTA_gene <- remap_accessions_refseq_to_gene_fasta(    path_to_FASTA,    organism_name = \"Rattus norvegicus\" )"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"msms-id-filter-at-protein-level","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"MS/MS ID filter at protein level","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"ago proteomics field established hard--fast two peptide per protein rule. protein identified one peptide considered confident identification. works OK, room improvement. example rule really penalizes short protens. long proteins (e.g. Titin 3.8 MDa) easily two matching peptides even reversed sequence. Thus, propose normalize number peptides per protein length use filtering criterion.","code":"msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA_gene) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 41743 at 0.74 % FDR ## #peptides: 12201 at 0.99 % FDR ## #accessions: 3876 at 2.7 % FDR msnid <- filter_msgf_data_protein_level(msnid, 0.01) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 32271 at 0.35 % FDR ## #peptides: 9001 at 0.39 % FDR ## #accessions: 2546 at 0.99 % FDR"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"inference-of-parsimonious-protein-set","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Inference of parsimonious protein set","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"situation sequence certain peptide matches multiple proteins adds complication downstream quantitative analysis clear protein product peptide originating . common ways selecting protein set. One simply retain uniquely matching peptides (unique_only=TRUE). Shared peptides simply discarded case. Alternatively (case unique_only=FALSE) shared peptides assigned proteins larger number uniquely mapping peptides. choice multiple proteins equal number uniquely mapping peptides, shared peptides assigned first protein according alphanumeric order.","code":"msnid <- infer_parsimonious_accessions(msnid, unique_only=TRUE) show(msnid) ## MSnID object ## Working directory: \".\" ## #Spectrum Files:  4  ## #PSMs: 24709 at 0.45 % FDR ## #peptides: 7851 at 0.41 % FDR ## #accessions: 2177 at 0.97 % FDR"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"remove-decoy-accessions","dir":"Articles","previous_headings":"Prepare MS/MS IDs","what":"Remove decoy accessions","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"","code":"msnid <- apply_filter(msnid, \"!isDecoy\")"},{"path":[]},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"read-masic-ouput","dir":"Articles","previous_headings":"Prepare reporter ion intensities","what":"Read MASIC ouput","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"MASIC tool extracting ion intensities. proper parameter settings can used extracting TMT (iTRAQ) reporter ion intensities. addition reporter number helpful metrics. interest interference score parent ion level S/N reporter ion level. Interference score reflects proportion ion population isolated fragmentation due targeted ion. words 1 - InterferenceScore due co-isolated species similar elution time parent ion m/z. S/N reporter level metric computed Thermo software.","code":"masic_data <- read_masic_data_from_DMS(data_package_num,                                         interference_score=TRUE) ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% ##    |                                                                               |                                                                      |   0%   |                                                                               |==================                                                    |  25%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================================                  |  75%   |                                                                               |======================================================================| 100% head(masic_data) ##                                              Dataset ScanNumber Ion_126.128 ## 1: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          2    70562.39 ## 2: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          3    23706.89 ## 3: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          4    12459.86 ## 4: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          5        0.00 ## 5: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          6        0.00 ## 6: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02          8     6166.82 ##    Ion_127.125 Ion_127.131 Ion_128.128 Ion_128.134 Ion_129.131 Ion_129.138 ## 1:    24864.62    17165.80    35625.00    92236.87     9640.23     8578.05 ## 2:    13559.32     5856.83    16322.71    34294.90     4853.11     7938.24 ## 3:    11785.91    10932.51    10653.32    12328.62     5959.86     9905.82 ## 4:        0.00        0.00        0.00        0.00        0.00        0.00 ## 5:    10998.67        0.00    21077.05     2725.50        0.00        0.00 ## 6:     1371.27     2418.35     8087.76     5485.35        0.00        0.00 ##    Ion_130.135 Ion_130.141 Ion_131.138 Ion_126.128_SignalToNoise ## 1:     6996.69    11833.07    32281.34                     71.47 ## 2:        0.00     1465.03    18182.27                     26.12 ## 3:     8387.04    11166.70    14053.40                     12.40 ## 4:        0.00        0.00        0.00                        NA ## 5:        0.00        0.00     6800.70                        NA ## 6:     1543.48     1943.96     7436.60                      6.92 ##    Ion_127.125_SignalToNoise Ion_127.131_SignalToNoise ## 1:                     25.17                     17.38 ## 2:                     14.94                      6.45 ## 3:                     11.75                     10.90 ## 4:                        NA                        NA ## 5:                      9.19                        NA ## 6:                      1.54                      2.71 ##    Ion_128.128_SignalToNoise Ion_128.134_SignalToNoise ## 1:                     36.04                     93.32 ## 2:                     17.97                     37.77 ## 3:                     10.64                     12.31 ## 4:                        NA                        NA ## 5:                     17.57                      2.27 ## 6:                      9.04                      6.13 ##    Ion_129.131_SignalToNoise Ion_129.138_SignalToNoise ## 1:                      9.75                      8.67 ## 2:                      5.34                      8.74 ## 3:                      5.96                      9.91 ## 4:                        NA                        NA ## 5:                        NA                        NA ## 6:                        NA                        NA ##    Ion_130.135_SignalToNoise Ion_130.141_SignalToNoise ## 1:                      7.07                     11.96 ## 2:                        NA                      1.61 ## 3:                      8.40                     11.18 ## 4:                        NA                        NA ## 5:                        NA                        NA ## 6:                      1.72                      2.16 ##    Ion_131.138_SignalToNoise InterferenceScore ## 1:                     32.71            0.9961 ## 2:                     19.93            0.9925 ## 3:                     14.13            1.0000 ## 4:                        NA            1.0000 ## 5:                      5.66            1.0000 ## 6:                      8.26            0.9688"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"filtering-masic-data","dir":"Articles","previous_headings":"Prepare reporter ion intensities","what":"Filtering MASIC data","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"case (currently recommended filters) require least 50% ion population due targeted ion filter S/N level.","code":"nrow(masic_data) ## [1] 133310 masic_data <- filter_masic_data(masic_data, 0.5, 0) nrow(masic_data) ## [1] 127440"},{"path":[]},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"laying-out-study-desing","dir":"Articles","previous_headings":"Creating cross-tab","what":"Laying out study desing","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"convert PSMs reporter ion intensities meaningful quantitative data necessary know samples reporter channels intended reference channel (combination channels). entire study desing captured three tables - fractions, samples, references.","code":""},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"fractions","dir":"Articles","previous_headings":"Creating cross-tab","what":"Fractions","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"Dataset fraction assigment can read separate file inferred dataset names. example shows latter.","code":"library(dplyr) fractions <- masic_data %>%    distinct(Dataset) %>%    mutate(PlexID =sub(\"MoTrPAC_Pilot_TMT_W_(S\\\\d).*\",\"\\\\1\",Dataset)) head(fractions) ##                                              Dataset PlexID ## 1: MoTrPAC_Pilot_TMT_W_S1_01_12Oct17_Elm_AQ-17-09-02     S1 ## 2: MoTrPAC_Pilot_TMT_W_S1_02_12Oct17_Elm_AQ-17-09-02     S1 ## 3: MoTrPAC_Pilot_TMT_W_S2_01_12Oct17_Elm_AQ-17-09-02     S2 ## 4: MoTrPAC_Pilot_TMT_W_S2_02_12Oct17_Elm_AQ-17-09-02     S2"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"samples","dir":"Articles","previous_headings":"Creating cross-tab","what":"Samples","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"links plex ID, reporter channel samples. minor difference ReporterAlias MeasurementName. MeasurementName sample name finally reported. ReporterAlias itermediate ReporterName MeasurementName used defining reference . may way query DMS. point, ’ll read file PlexedPiperTestData package.","code":"library(readr) samples <- read_tsv(system.file(\"extdata/study_design/samples.txt\",                                  package = \"PlexedPiperTestData\")) head(samples,10) ## # A tibble: 10 x 5 ##    PlexID QuantBlock ReporterName ReporterAlias MeasurementName ##    <chr>       <dbl> <chr>        <chr>         <chr>           ##  1 S1              1 126          R_01          R_01            ##  2 S1              1 127N         R_03          R_03            ##  3 S1              1 127C         R_02          R_02            ##  4 S1              1 128N         R_05          R_05            ##  5 S1              1 128C         R_04          R_04            ##  6 S1              1 129N         S_02          S_02            ##  7 S1              1 129C         S_01          S_01            ##  8 S1              1 130N         S_04          S_04            ##  9 S1              1 130C         S_03          S_03            ## 10 S1              1 131          ref           NA"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"references","dir":"Articles","previous_headings":"Creating cross-tab","what":"References","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"Reference can certain channel, average multiple channels 1. general form expression ReporterAlias names variables. evaluated PlexID/QuantBlock combination applied divide reporter ion intensities within corresponding PlexID/QuantBlock. QuantBlock can though way defining sub-plex. typical TMT experiment QuantBlock always 1. case 5 pairwise comparisons within TMT10, 5 QuantBlocks (1..5) reference QuantBlock.","code":"references <- read_tsv(system.file(\"extdata/study_design/references.txt\",                                    package = \"PlexedPiperTestData\")) head(references) ## # A tibble: 2 x 3 ##   PlexID QuantBlock Reference ##   <chr>       <dbl> <chr>     ## 1 S1              1 ref       ## 2 S2              1 ref"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"reading-study-desing-tables-from-dms-data-package-locations","dir":"Articles","previous_headings":"Creating cross-tab","what":"Reading Study Desing Tables from DMS Data Package Locations","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"convention, study design tables stored data package folder DMS.","code":"study_design_tables <- get_study_design_by_dataset_package(data_package_num) fractions <- study_design_tables$fractions samples <- study_design_tables$samples references <- study_design_tables$references"},{"path":"/articles/tmt_pipeline_v1_PNNL_DMS.html","id":"creating-quantitative-cross-tab","dir":"Articles","previous_headings":"Creating cross-tab","what":"Creating quantitative cross-tab","title":"Suggested TMT processing pipeline. Variant 1.\nVersion for PNNL DMS.\n","text":"Final step MS/MS IDs reporter ions linked together, aggregated peptide accession (.e. protein) level. retain protein IDs aggregating peptide level suggest aggregation_level <- c(\"accession\",\"peptide\")","code":"aggregation_level <- c(\"accession\") quant_cross_tab <- create_crosstab(msnid,                                     masic_data,                                     aggregation_level,                                     fractions, samples, references) dim(quant_cross_tab) ## [1] 2139   18 head(quant_cross_tab) ##                  R_01        R_02       R_03       R_04        R_05       R_06 ## Aar2     -0.425833947 -0.22750410 -0.6327384 -0.4048138 -0.73984597 -0.7172948 ## Aars1    -0.008546235  0.52299585 -0.2036391  0.6233634  0.07777239 -0.5622245 ## Aarsd1   -0.493124181 -0.35221180 -0.5862425 -0.5514507 -0.38723986 -0.9480688 ## Aasdhppt -0.200080510 -0.13412432 -0.4803332 -0.2467851 -0.41344771 -1.1163904 ## Abca8a    0.283514199 -0.39489529 -0.4669246  0.4997377 -0.15585177 -0.9529543 ## Abce1    -0.203748867 -0.05895448 -0.5425011 -0.2043721 -0.56510223 -0.8850411 ##                R_07       R_08        R_09        S_01       S_02       S_03 ## Aar2     -0.6163162 -0.4042819  0.02866391 -0.70296182 -0.9735167 -0.6317493 ## Aars1    -0.7671264 -0.2315158 -0.07181637  0.57198798  0.3015500 -0.9327534 ## Aarsd1   -0.4499616 -0.5698316  0.11402759 -0.37631743 -0.8747977 -0.7770647 ## Aasdhppt -0.5757046 -0.4377226 -0.19366971 -0.24615471 -0.9968443 -0.5490088 ## Abca8a   -0.4159341 -1.0386196 -0.24260970 -0.76533025 -0.9532367 -0.8305449 ## Abce1    -0.5483659 -0.2931637 -0.24382560 -0.09552006 -0.7113775 -0.3476251 ##               S_04        S_05       S_06       S_07         S_08       S_09 ## Aar2     -1.109744  0.14079541 -0.3316805 -0.2181399 -0.688556180 -0.4159851 ## Aars1    -1.998359 -0.51237843 -0.2288511  0.1927945 -0.781111333 -0.2018680 ## Aarsd1   -1.018867  0.06778754 -0.2433397 -0.3223110 -0.621658332 -0.5719310 ## Aasdhppt -1.176248 -0.20778376 -0.4001400 -0.3037711 -0.638977431 -0.8141141 ## Abca8a   -1.202985  0.66608421 -0.6555453 -0.6781002 -0.004690478 -0.8620336 ## Abce1    -1.058931 -0.16501937  0.1116517 -0.2789690 -0.573212645 -0.4013663"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Vladislav Petyuk. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"vladislav.petyuk@pnnl.gov VP (2022). PlexedPiper: Pipeline isobaric quantification. R package version 0.3.5.","code":"@Manual{,   title = {PlexedPiper: Pipeline for isobaric quantification},   author = {Vladislav Petyuk vladislav.petyuk@pnnl.gov},   year = {2022},   note = {R package version 0.3.5}, }"},{"path":"/index.html","id":"plexedpiper","dir":"","previous_headings":"","what":"Pipeline for isobaric quantification","title":"Pipeline for isobaric quantification","text":"R package used PNNL processing isobaric labeling (e.g. TMT) proteomics data. key inputs : MS/MS identifications MS-GF+ search engine Reporter ion intensities extracted using MASIC table linking dataset plexes table linking reporter channels sample names table identifying reference within plex","code":""},{"path":"/index.html","id":"updates","dir":"","previous_headings":"","what":"Updates","title":"Pipeline for isobaric quantification","text":"Updates package detailed NEWS.md file releases.","code":""},{"path":"/index.html","id":"website","dir":"","previous_headings":"","what":"Website","title":"Pipeline for isobaric quantification","text":"PlexedPiper pkgdown website contains pre-built vignettes well updates documentation.","code":""},{"path":"/index.html","id":"r-installation-and-usage","dir":"","previous_headings":"","what":"R Installation and Usage","title":"Pipeline for isobaric quantification","text":"","code":"if(!require(\"remotes\", quietly = T)) install.packages(\"remotes\") remotes::install_github(\"PNNL-Comp-Mass-Spec/PlexedPiper\", build_vignettes = TRUE) library(PlexedPiper) vignette(\"tmt_pipeline_v1\")"},{"path":"/index.html","id":"example-data","dir":"","previous_headings":"R Installation and Usage","what":"Example Data","title":"Pipeline for isobaric quantification","text":"companion R package test data based MoTrPAC pilot study available PlexedPiperTestData","code":""},{"path":"/index.html","id":"dockerlinux-installation","dir":"","previous_headings":"","what":"Docker/Linux installation","title":"Pipeline for isobaric quantification","text":"PlexedPiper can run within Docker Container example Dockerfile shows required system libraries, starting base rocker/TidyVerse image","code":"FROM rocker/tidyverse:3.6.1 RUN apt-get update \\  && apt-get install -y --no-install-recommends \\  unixodbc \\  unixodbc-dev \\  freetds-dev \\  freetds-bin \\  tdsodbc \\  libcurl4-openssl-dev \\  libxml2-dev \\  libnetcdf-dev \\  libssl-dev RUN R -e 'remotes::install_github(\"PNNL-Comp-Mass-Spec/PlexedPiper\", build_vignettes = TRUE)'"},{"path":"/index.html","id":"macos-installation","dir":"","previous_headings":"","what":"MacOS installation","title":"Pipeline for isobaric quantification","text":"MacOS, install Homebrew, use Note, ---unixodbc option freetds installation deprecated. Create ~/.odbcinst.ini file add location libtdsodbc.differs, use proper location.","code":"brew install unixodbc brew install freetds [FreeTDS] Driver = /usr/local/lib/libtdsodbc.so"},{"path":"/index.html","id":"installation-tips","dir":"","previous_headings":"MacOS installation","what":"Installation Tips","title":"Pipeline for isobaric quantification","text":"within PNNL network may error associated mount_smbfs. happens due network access credentials. Options either wait proactively access one PNNL servers. example try mounting one public directories terminal window. Enter network password requested. mount -t smbfs //protoapps/DataPkgs/Public/ ~/temp_msms_results compilation vignettes imply access PNNL DMS proceed smoothly.","code":""},{"path":"/index.html","id":"original-location","dir":"","previous_headings":"","what":"Original Location","title":"Pipeline for isobaric quantification","text":"original location vladpetyuk account, repo PlexedPiper.","code":""},{"path":"/reference/best_PTM_location_by_ascore.html","id":null,"dir":"Reference","previous_headings":"","what":"Improve Phosphosite Localization — best_PTM_location_by_ascore","title":"Improve Phosphosite Localization — best_PTM_location_by_ascore","text":"Use AScore results improve phosphosite localization.","code":""},{"path":"/reference/best_PTM_location_by_ascore.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Improve Phosphosite Localization — best_PTM_location_by_ascore","text":"","code":"best_PTM_location_by_ascore(msnid, ascore)"},{"path":"/reference/best_PTM_location_by_ascore.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Improve Phosphosite Localization — best_PTM_location_by_ascore","text":"msnid (MSnID object) MS/MS ID data ascore (data.frame) AScore results","code":""},{"path":"/reference/best_PTM_location_by_ascore.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Improve Phosphosite Localization — best_PTM_location_by_ascore","text":"(MSnID object) MS/MS ID data added AScore","code":""},{"path":"/reference/best_PTM_location_by_ascore.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Improve Phosphosite Localization — best_PTM_location_by_ascore","text":"","code":"if (FALSE) { # Get AScore results path_to_ascore <- system.file(\"extdata/phospho/ascore_output\",                               package = \"PlexedPiperTestData\") ascore <- read_AScore_results(path_to_ascore)  # MS/MS IDs path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results)  # Improve phosphosite localization msnid <- best_PTM_location_by_ascore(msnid, ascore) }"},{"path":"/reference/compute_num_peptides_per_1000aa.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute number of peptides per 1000 aa — compute_num_peptides_per_1000aa","title":"Compute number of peptides per 1000 aa — compute_num_peptides_per_1000aa","text":"Computing number peptides per 1000 amino acids.","code":""},{"path":"/reference/compute_num_peptides_per_1000aa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute number of peptides per 1000 aa — compute_num_peptides_per_1000aa","text":"","code":"compute_num_peptides_per_1000aa(msnid, path_to_FASTA)"},{"path":"/reference/compute_num_peptides_per_1000aa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute number of peptides per 1000 aa — compute_num_peptides_per_1000aa","text":"msnid (MSnID object) MS/MS ID data path_to_FASTA (character) Path FASTA file.","code":""},{"path":"/reference/compute_num_peptides_per_1000aa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute number of peptides per 1000 aa — compute_num_peptides_per_1000aa","text":"(MSnID object) MS/MS ID data computed number peptides per   1000 aa. Added column name - \"peptides_per_1000aa\".","code":""},{"path":"/reference/compute_num_peptides_per_1000aa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute number of peptides per 1000 aa — compute_num_peptides_per_1000aa","text":"","code":"if (FALSE) { path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) path_to_FASTA <- system.file(   \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",   package = \"PlexedPiperTestData\" ) msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA) hist(msnid$peptides_per_1000aa) }"},{"path":"/reference/create_crosstab.html","id":null,"dir":"Reference","previous_headings":"","what":"Makes Cross-Tab With Quantitative Data. — create_crosstab","title":"Makes Cross-Tab With Quantitative Data. — create_crosstab","text":"Links filtered MS/MS IDs reporter intensities. Divides reporter ion intensities corresponding reference returns cross-tab. Rows species (e.g. proteins global, phosphopeptides phosphoproteomic experiment), columns sample names.","code":""},{"path":"/reference/create_crosstab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Makes Cross-Tab With Quantitative Data. — create_crosstab","text":"","code":"create_crosstab(   msnid,   reporter_intensities,   aggregation_level,   fractions,   samples,   references )"},{"path":"/reference/create_crosstab.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Makes Cross-Tab With Quantitative Data. — create_crosstab","text":"msnid (MSnID object) filtered MS/MS identifications reporter_intensities (object coercible data.table) collated table filtered reporter intensities. aggregation_level (character) defines intensities needs aggregated. point aggregation function `sum`. Typically, intensities different fractions plex aggregated. Also (e.g. global proteomics) intensities different scans identifying peptides protein aggregated together . fractions (object coercible data.table) fractions study design table Dataset PlexID columns. samples (object coercible data.table) samples study design table columns PlexID, QuantBlock, ReporterName, ReporterAlias, MeasurementName. references (object coercible data.table) references study design table columns PlexID, QuantBlock, Reference.","code":""},{"path":"/reference/create_crosstab.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Makes Cross-Tab With Quantitative Data. — create_crosstab","text":"(matrix) log2-transformed relative reporter ion intensities. Row   names names measured species. Column names names   samples.","code":""},{"path":"/reference/create_crosstab.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Makes Cross-Tab With Quantitative Data. — create_crosstab","text":"","code":"if (FALSE) { # Prepare MS/MS IDs path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) msnid <- MSnID::correct_peak_selection(msnid) show(msnid) msnid <- filter_msgf_data_peptide_level(msnid, 0.01) show(msnid) path_to_FASTA <- system.file(   \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",   package = \"PlexedPiperTestData\" ) msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA) msnid <- filter_msgf_data_protein_level(msnid, 0.01) show(msnid)  # Prepare table with reporter ion intensities path_to_MASIC_results <- system.file(\"extdata/global/masic_output\",                                      package = \"PlexedPiperTestData\") masic_data <- read_masic_data(path_to_MASIC_results,                               interference_score = TRUE) masic_data <- filter_masic_data(masic_data, 0.5, 0)  # Creating cross-tab library(readr) fractions <- read_tsv(system.file(\"extdata/study_design/fractions.txt\",                                   package = \"PlexedPiperTestData\")) samples <- read_tsv(system.file(\"extdata/study_design/samples.txt\",                                 package = \"PlexedPiperTestData\")) references <- read_tsv(system.file(\"extdata/study_design/references.txt\",                                    package = \"PlexedPiperTestData\")) aggregation_level <- c(\"accession\")  out <- create_crosstab(msnid, masic_data, aggregation_level,                        fractions, samples, references) dim(out) head(out) }"},{"path":"/reference/create_msnset.html","id":null,"dir":"Reference","previous_headings":"","what":"Makes MSnSet from Quantitative Crosstab. — create_msnset","title":"Makes MSnSet from Quantitative Crosstab. — create_msnset","text":"Creates MSnSet object quantitative crosstab attached phenotype data.","code":""},{"path":"/reference/create_msnset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Makes MSnSet from Quantitative Crosstab. — create_msnset","text":"","code":"create_msnset(crosstab, samples)"},{"path":"/reference/create_msnset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Makes MSnSet from Quantitative Crosstab. — create_msnset","text":"crosstab (matrix) log2-transformed relative reporter ion intensities. Row names names measured species. Column names names samples. samples (data.table data.frame) matches sample names reporter ions.","code":""},{"path":"/reference/create_msnset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Makes MSnSet from Quantitative Crosstab. — create_msnset","text":"MSnSet object log2-transformed relative reporter ion   intensities expression data samples table phenotype data.","code":""},{"path":"/reference/create_msnset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Makes MSnSet from Quantitative Crosstab. — create_msnset","text":"","code":"if (FALSE) { # Prepare MS/MS IDs path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) msnid <- MSnID::correct_peak_selection(msnid) show(msnid) msnid <- filter_msgf_data_peptide_level(msnid, 0.01) show(msnid) path_to_FASTA <- system.file(   \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",   package = \"PlexedPiperTestData\" ) msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA) msnid <- filter_msgf_data_protein_level(msnid, 0.01) show(msnid)  # Prepare table with reporter ion intensities path_to_MASIC_results <- system.file(\"extdata/global/masic_output\",                                      package = \"PlexedPiperTestData\") masic_data <- read_masic_data(path_to_MASIC_results,                               interference_score = TRUE) masic_data <- filter_masic_data(masic_data, 0.5, 0)  # Creating cross-tab library(readr) fractions <- read_tsv(system.file(\"extdata/study_design/fractions.txt\",                                   package = \"PlexedPiperTestData\")) samples <- read_tsv(system.file(\"extdata/study_design/samples.txt\",                                 package = \"PlexedPiperTestData\")) references <- read_tsv(system.file(\"extdata/study_design/references.txt\",                                    package = \"PlexedPiperTestData\"))  aggregation_level <- c(\"accession\")  crosstab <- create_crosstab(msnid, masic_data, aggregation_level,                             fractions, samples, references) m <- create_msnset(crosstab, samples) dim(m) library(MSnbase) head(exprs(m)) }"},{"path":"/reference/filter_masic_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Filtering MASIC Data — filter_masic_data","title":"Filtering MASIC Data — filter_masic_data","text":"Filtering MASIC data interference score signal--noise ratio (S/N) individual channels. Note: function current form also drops 40 columns data.frame. E.g. TMT10 table contains 62 columns. filtering, remaining columns 10 TMT channels, Dataset, ScanNumber.","code":""},{"path":"/reference/filter_masic_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filtering MASIC Data — filter_masic_data","text":"","code":"filter_masic_data(x, interference_score_threshold = 0.9, s2n_threshold = 4)"},{"path":"/reference/filter_masic_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filtering MASIC Data — filter_masic_data","text":"x (data.frame) collated MASIC output interference_score_threshold (numeric) interference score reflects proportion ion population isolated fragmentation due targeted ion. 1 - InferferenceScore due co-isolated species. higher interference score, cleaner parent ion MS1 level. Default 0.9. s2n_threshold (numeric) S/N calculated vendor extracted MASIC raw files. Default 4.","code":""},{"path":"/reference/filter_masic_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filtering MASIC Data — filter_masic_data","text":"(data.frame) filtered MASIC output","code":""},{"path":"/reference/filter_masic_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filtering MASIC Data — filter_masic_data","text":"Default values interference_score_threshold = 0.9 s2n_threshold = 4 fairly stringent. recommend least setting interference_score_threshold = 0.5 s2n_threshold = 0. filtering intended, use filter_masic_data(x,0,0).","code":""},{"path":"/reference/filter_masic_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filtering MASIC Data — filter_masic_data","text":"","code":"if (FALSE) { path_to_MASIC_results <- system.file(\"extdata/global/masic_output\",                                      package = \"PlexedPiperTestData\") x <- read_masic_data(path_to_MASIC_results, interference_score = TRUE) dim(x) x1 <- filter_masic_data(x,0,0) dim(x1) x2 <- filter_masic_data(x) dim(x2) }"},{"path":"/reference/filter_msgf_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Filtering MSGF Data — filter_msgf_data","title":"Filtering MSGF Data — filter_msgf_data","text":"Filtering MSGF data. implementation, peptide-level filter optimizes ppm PepQValue thresholds achieve maximum number peptide identifications within given FDR constraint. accession-level filter optimizes based peptides_per_1000aa, compute_num_peptides_per_1000aa must used first.","code":""},{"path":"/reference/filter_msgf_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filtering MSGF Data — filter_msgf_data","text":"","code":"filter_msgf_data(   msnid,   level,   fdr.max = 0.01,   n.iter.grid = 500,   n.iter.nm = 100 )  filter_msgf_data_peptide_level(msnid, ...)  filter_msgf_data_protein_level(msnid, ...)"},{"path":"/reference/filter_msgf_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filtering MSGF Data — filter_msgf_data","text":"msnid (MSnID object) collated MSGF output level (character) Level perform FDR filter. name column psms(msnid). Currently, \"peptide\" \"accession\" supported. fdr.max (numeric) Maximum acceptable FDR. Default 0.01 (1%). n.iter.grid (numeric) number grid-distributed evaluation points. n.iter.nm (numeric) number iterations Nelder-Mead optimization algorithm. ... arguments passed filter_msgf_data.","code":""},{"path":"/reference/filter_msgf_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filtering MSGF Data — filter_msgf_data","text":"(MSnID object) filtered MSGF output","code":""},{"path":[]},{"path":"/reference/filter_msgf_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filtering MSGF Data — filter_msgf_data","text":"","code":"if (FALSE) { path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) msnid <- MSnID::correct_peak_selection(msnid) show(msnid) msnid <- filter_msgf_data(msnid, \"peptide\", 0.01) # 1% FDR at peptide level show(msnid) path_to_FASTA <- system.file(   \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",   package = \"PlexedPiperTestData\" ) msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA) msnid <- filter_msgf_data(msnid, \"accession\", 0.01) # 1% FDR at protein level show(msnid) }"},{"path":"/reference/filter_msgf_data_missed_cleavages.html","id":null,"dir":"Reference","previous_headings":"","what":"Filtering MSGF Data — filter_msgf_data_missed_cleavages","title":"Filtering MSGF Data — filter_msgf_data_missed_cleavages","text":"Filtering MSGF data number missed cleavages.","code":""},{"path":"/reference/filter_msgf_data_missed_cleavages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filtering MSGF Data — filter_msgf_data_missed_cleavages","text":"","code":"filter_msgf_data_missed_cleavages(msnid, missed_cleavages_threshold = 2)"},{"path":"/reference/filter_msgf_data_missed_cleavages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filtering MSGF Data — filter_msgf_data_missed_cleavages","text":"msnid (MSnID object) collated MSGF output missed_cleavages_threshold (numeric) Maximum acceptable number missed cleavages. Default 2.","code":""},{"path":"/reference/filter_msgf_data_missed_cleavages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filtering MSGF Data — filter_msgf_data_missed_cleavages","text":"(MSnID object) filtered MSGF output","code":""},{"path":[]},{"path":"/reference/filter_msgf_data_missed_cleavages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filtering MSGF Data — filter_msgf_data_missed_cleavages","text":"","code":"if (FALSE) { path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) msnid <- MSnID::correct_peak_selection(msnid) show(msnid) # At most 2 missed cleavages msnid <-  filter_msgf_data_missed_cleavages(msnid, 2) show(msnid) }"},{"path":"/reference/motrpac_bic_output.html","id":null,"dir":"Reference","previous_headings":"","what":"Format Tables for BIC — motrpac_bic_output","title":"Format Tables for BIC — motrpac_bic_output","text":"Assembles data format compliant BIC requirements.","code":""},{"path":"/reference/motrpac_bic_output.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format Tables for BIC — motrpac_bic_output","text":"","code":"make_rii_peptide_gl(   msnid,   masic_data,   fractions,   samples,   references,   annotation,   org_name = \"Rattus norvegicus\" )  make_results_ratio_gl(   msnid,   masic_data,   fractions,   samples,   references,   annotation,   org_name = \"Rattus norvegicus\" )  make_rii_peptide_ph(   msnid,   masic_data,   fractions,   samples,   references,   annotation,   org_name = \"Rattus norvegicus\",   sep = \"_\" )  make_results_ratio_ph(   msnid,   masic_data,   fractions,   samples,   references,   annotation,   org_name = \"Rattus norvegicus\",   sep = \"_\" )  assess_redundant_protein_matches(msnid, collapse = \"|\")  assess_noninferable_proteins(msnid, collapse = \"|\")"},{"path":"/reference/motrpac_bic_output.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format Tables for BIC — motrpac_bic_output","text":"msnid (MSnID object) final filtered version MSnID object masic_data (object coercible data.table) final filtered version MASIC table fractions (object coercible data.table) study design table linking Dataset PlexID samples (object coercible data.table) study design table linking sample names TMT channels PlexID references (object coercible data.table) study design table describing reference value calculation annotation (character) format accessions(msnid). Either \"refseq\" \"uniprot\" (case insensitive). org_name (character) scientific name organism (e.g. \"Homo sapiens\", \"Rattus norvegicus\", \"Mus musculus\", etc.). Case sensitive. sep (character) used concatenate protein, SiteID, peptide. collapse (character) used collapse proteins assess_redundant_protein_matches","code":""},{"path":"/reference/motrpac_bic_output.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Format Tables for BIC — motrpac_bic_output","text":"ratio rii functions require columns \"redundantAccessions\", \"noninferableProteins\" \"percentAACoverage\" (created compute_accession_coverage) present psms(msnid). make_rii_peptide_gl: returns 'RII_peptide.txt' table (global) make_results_ratio_gl: returns 'results_ratio.txt' table (global) make_rii_peptide_ph: returns 'RII_peptide.txt' table (phospho) make_results_ratio_ph: returns 'results_ratio.txt' table (phospho) assess_redundant_protein_matches: appends proteins matched multiple peptides. Creates \"redundantAccessions\" column psms(msnid). assess_noninferable_proteins: appends proteins identical peptide sets. Creates \"noninferableProteins\" column psms(msnid).","code":""},{"path":"/reference/motrpac_bic_output.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format Tables for BIC — motrpac_bic_output","text":"","code":"if (FALSE) { # Prepare MS/MS IDs ---- path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) msnid <- MSnID::correct_peak_selection(msnid) show(msnid) msnid <- filter_msgf_data_peptide_level(msnid, 0.01) show(msnid) path_to_FASTA <- system.file(   \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",   package = \"PlexedPiperTestData\" ) msnid <- compute_num_peptides_per_1000aa(msnid, path_to_FASTA) msnid <- filter_msgf_data_protein_level(msnid, 0.01) show(msnid) msnid <- assess_redundant_protein_matches(msnid) msnid <- assess_noninferable_proteins(msnid) fst <- Biostrings::readAAStringSet(path_to_FASTA) names(fst) <- gsub(\" .*\", \"\", names(fst)) # make names match accessions msnid <- MSnID::compute_accession_coverage(msnid, fst) head(psms(msnid))  # Prepare table with reporter ion intensities ---- path_to_MASIC_results <- system.file(\"extdata/global/masic_output\",                                      package = \"PlexedPiperTestData\") masic_data <- read_masic_data(path_to_MASIC_results,                               interference_score = TRUE) masic_data <- filter_masic_data(masic_data, 0.5, 0)  # Read study design files ---- library(readr) fractions <- read_tsv(system.file(\"extdata/study_design/fractions.txt\",                                   package = \"PlexedPiperTestData\")) samples <- read_tsv(system.file(\"extdata/study_design/samples.txt\",                                 package = \"PlexedPiperTestData\")) references <- read_tsv(system.file(\"extdata/study_design/references.txt\",                                    package = \"PlexedPiperTestData\"))  # Create final tables ---- results_ratio <- make_results_ratio_gl(msnid, masic_data,                                        fractions, samples, references,                                        annotation = \"RefSeq\",                                        org_name = \"Rattus norvegicus\") head(results_ratio, 10)  rii_peptide <- make_rii_peptide_gl(msnid, masic_data,                                    fractions, samples, references,                                    annotation = \"RefSeq\",                                    org_name = \"Rattus norvegicus\") head(rii_peptide, 10)  # Clean-up cache unlink(\".Rcache\", recursive = TRUE) }"},{"path":"/reference/read_AScore_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Read AScore results from folder — read_AScore_results","title":"Read AScore results from folder — read_AScore_results","text":"function reads AScore results local folder.","code":""},{"path":"/reference/read_AScore_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read AScore results from folder — read_AScore_results","text":"","code":"read_AScore_results(path_to_AScore_results)"},{"path":"/reference/read_AScore_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read AScore results from folder — read_AScore_results","text":"path_to_AScore_results (character) path folder containing file ending \"_syn_ascore.txt\".","code":""},{"path":"/reference/read_AScore_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read AScore results from folder — read_AScore_results","text":"data.frame AScore results","code":""},{"path":"/reference/read_AScore_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read AScore results from folder — read_AScore_results","text":"","code":"if (FALSE) { # Get AScore results path_to_AScore_results <- system.file(\"extdata/phospho/ascore_output\",                                       package = \"PlexedPiperTestData\") ascore <- read_AScore_results(path_to_AScore_results) }"},{"path":"/reference/read_masic_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Reading MASIC Results. Generic. — read_masic_data","title":"Reading MASIC Results. Generic. — read_masic_data","text":"Reading MASIC output single directory","code":""},{"path":"/reference/read_masic_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reading MASIC Results. Generic. — read_masic_data","text":"","code":"read_masic_data(path_to_MASIC_results, interference_score = FALSE)"},{"path":"/reference/read_masic_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reading MASIC Results. Generic. — read_masic_data","text":"path_to_MASIC_results (character) path directory MASIC results datasets. interference_score (logical) whether read interference score.","code":""},{"path":"/reference/read_masic_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reading MASIC Results. Generic. — read_masic_data","text":"(data.frame) reporter ion intensities metrics.","code":""},{"path":"/reference/read_masic_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reading MASIC Results. Generic. — read_masic_data","text":"","code":"if (FALSE) { path_to_MASIC_results <- system.file(\"extdata/global/masic_output\",                                      package = \"PlexedPiperTestData\") x <- read_masic_data(path_to_MASIC_results, interference_score=TRUE) head(x) }"},{"path":"/reference/read_msgf_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Reading MSGF Results. Generic. — read_msgf_data","title":"Reading MSGF Results. Generic. — read_msgf_data","text":"Reading MSGF output single directory.","code":""},{"path":"/reference/read_msgf_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reading MSGF Results. Generic. — read_msgf_data","text":"","code":"read_msgf_data(path_to_MSGF_results, suffix = character(0))"},{"path":"/reference/read_msgf_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reading MSGF Results. Generic. — read_msgf_data","text":"path_to_MSGF_results (character) path directory MSGF results datasets. suffix (character) optional file suffix. Either \"_msgfplus_syn.txt\", \"_msgfdb_syn.txt\", \"_syn.txt\".","code":""},{"path":"/reference/read_msgf_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reading MSGF Results. Generic. — read_msgf_data","text":"(MSnID) MSnID object","code":""},{"path":"/reference/read_msgf_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reading MSGF Results. Generic. — read_msgf_data","text":"","code":"if (FALSE) { path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) print(msnid) head(MSnID::psms(msnid)) }"},{"path":"/reference/read_study_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Utilities for reading study design files. — read_study_design","title":"Utilities for reading study design files. — read_study_design","text":"Fetches study design results local folder. Checks study design files internally consistent.","code":""},{"path":"/reference/read_study_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utilities for reading study design files. — read_study_design","text":"","code":"read_study_design(path_to_study_design)"},{"path":"/reference/read_study_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utilities for reading study design files. — read_study_design","text":"path_to_study_design (character) path folder containing study design files.","code":""},{"path":"/reference/read_study_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Utilities for reading study design files. — read_study_design","text":"list study design tables, accessible $ [].","code":""},{"path":"/reference/read_study_design.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Utilities for reading study design files. — read_study_design","text":"","code":"path_to_study_design <- system.file(\"extdata/study_design\",                                     package = \"PlexedPiperTestData\") study_design <- read_study_design(path_to_study_design)  fractions  <- study_design$fractions samples    <- study_design$samples references <- study_design$references"},{"path":"/reference/remap_accessions.html","id":null,"dir":"Reference","previous_headings":"","what":"Remap accessions — remap_accessions","title":"Remap accessions — remap_accessions","text":"Converting accessions RefSeq Gene. conversion_table supplied, function leverages fetch_conversion_table.","code":""},{"path":"/reference/remap_accessions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remap accessions — remap_accessions","text":"","code":"remap_accessions_refseq_to_gene(msnid, organism_name, conversion_table)  remap_accessions_uniprot_to_gene(msnid, organism_name, conversion_table)"},{"path":"/reference/remap_accessions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remap accessions — remap_accessions","text":"msnid (MSnID object) MS/MS ID data organism_name (character) Scientific name organism. conversion_table (data.frame) Optional data.frame two columns. One column match accessions `msnid` object (e.g. RefSeq). column alternate annotation map (e.g. gene symbol).","code":""},{"path":"/reference/remap_accessions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remap accessions — remap_accessions","text":"(MSnID object) MS/MS ID data computed number peptides per   1000 aa. Added column name - \"peptides_per_1000aa\".","code":""},{"path":"/reference/remap_accessions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remap accessions — remap_accessions","text":"","code":"if (FALSE) { path_to_MSGF_results <- system.file(\"extdata/global/msgf_output\",                                     package = \"PlexedPiperTestData\") msnid <- read_msgf_data(path_to_MSGF_results) show(msnid) msnid <- remap_accessions_refseq_to_gene(msnid,                                          organism_name=\"Rattus norvegicus\") show(msnid) }"},{"path":"/reference/remap_accessions_fasta.html","id":null,"dir":"Reference","previous_headings":"","what":"Remap Sequence IDs in FASTA File — remap_accessions_fasta","title":"Remap Sequence IDs in FASTA File — remap_accessions_fasta","text":"functions remap IDs FASTA file RefSeq IDs UniProt accessions Gene symbols. single gene matches one protein sequence, longest sequence retained.","code":""},{"path":"/reference/remap_accessions_fasta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remap Sequence IDs in FASTA File — remap_accessions_fasta","text":"","code":"remap_accessions_refseq_to_gene_fasta(   path_to_FASTA,   organism_name,   conversion_table )  remap_accessions_uniprot_to_gene_fasta(path_to_FASTA)"},{"path":"/reference/remap_accessions_fasta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remap Sequence IDs in FASTA File — remap_accessions_fasta","text":"path_to_FASTA (character) path FASTA file. organism_name (character) scientific name organism (e.g. \"Homo sapiens\", \"Rattus norvegicus\", \"Mus musculus\", etc.). required conversion_table supplied. conversion_table (data.frame) optional data frame two columns: REFSEQ UNIPROT SYMBOL (order). provided, created fetch_conversion_table.","code":""},{"path":"/reference/remap_accessions_fasta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remap Sequence IDs in FASTA File — remap_accessions_fasta","text":"Path remapped FASTA file.","code":""},{"path":"/reference/remap_accessions_fasta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remap Sequence IDs in FASTA File — remap_accessions_fasta","text":"","code":"if (FALSE) { path_to_FASTA <- system.file(   \"extdata/Rattus_norvegicus_NCBI_RefSeq_2018-04-10.fasta.gz\",   package = \"PlexedPiperTestData\" ) temp_work_dir <- tempdir() # can be set to \".\" or getwd(), if done carefully file.copy(path_to_FASTA, temp_work_dir) path_to_FASTA <- file.path(temp_work_dir, basename(path_to_FASTA)) library(Biostrings) readAAStringSet(path_to_FASTA) # RefSeq IDs path_to_new_FASTA <- remap_accessions_refseq_to_gene_fasta(   path_to_FASTA, organism_name = \"Rattus norvegicus\" ) readAAStringSet(path_to_new_FASTA) # gene symbols }"},{"path":"/reference/reporter_converter.html","id":null,"dir":"Reference","previous_headings":"","what":"Converter for TMT Reporter Channels — reporter_converter","title":"Converter for TMT Reporter Channels — reporter_converter","text":"Converter human-readable notation TMT reporter channels m/z-type (reported MASIC).","code":""},{"path":"/reference/reporter_converter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converter for TMT Reporter Channels — reporter_converter","text":"","code":"reporter_converter"},{"path":"/reference/reporter_converter.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Converter for TMT Reporter Channels — reporter_converter","text":"data frame 10 rows 2 variables: ReporterName human-readable notation ReporterIon reporter channel names extracted MASIC","code":""},{"path":"/reference/reporter_converter.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Converter for TMT Reporter Channels — reporter_converter","text":"https://www.thermofisher.com/us/en/home/life-science/protein-biology/protein-mass-spectrometry-analysis/protein-quantitation-mass-spectrometry/tandem-mass-tag-systems.html","code":""},{"path":"/reference/run_plexedpiper.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper for PlexedPiper — run_plexedpiper","title":"Wrapper for PlexedPiper — run_plexedpiper","text":"wrapper function PlexedPiper performs steps necessary go MS-GF+ MASIC data Reporter Ion Intensity (RII) Ratio Results tables used MoTrPAC Bioinformatics Center (BIC).","code":""},{"path":"/reference/run_plexedpiper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper for PlexedPiper — run_plexedpiper","text":"","code":"run_plexedpiper(   msgf_output_folder,   fasta_file,   masic_output_folder,   ascore_output_folder = NULL,   proteomics,   study_design_folder,   species,   annotation,   file_prefix = NULL,   unique_only = FALSE,   global_results = NULL,   refine_prior = FALSE,   write_results_to_file = TRUE,   output_folder = NULL,   save_env = FALSE,   return_results = FALSE,   verbose = TRUE )"},{"path":"/reference/run_plexedpiper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper for PlexedPiper — run_plexedpiper","text":"msgf_output_folder (character) Path MSGF+ results folder fasta_file (character) Path FASTA file masic_output_folder (character) MASIC results folder ascore_output_folder (character) AScore results folder proteomics (character) Either \"pr\" - proteomics, \"ph\" - phosphoproteomics, \"ub\" - ubiquitinomics, \"ac\" - acetylomics study_design_folder (character) Folder containing three study design tables: fractions.txt, samples.txt, references.txt species (character) Scientific name species (e.g. \"Rattus norvegicus\", \"Homo sapiens\", etc.) annotation (character) Source annotations: either RefSeq UniProt (case insensitive). file_prefix (character) Prefix file name outputs. unique_only (logical) Whether discard peptides match multiple proteins parsimonious protein inference step. Default FALSE. global_results (character) PTM experiments. Ratio results global protein abundance experiment. provided, prioritized inference performed. Otherwise, parsimonious inference performed without prior. See infer_parsimonious_accessions details. refine_prior (logical) FALSE (default), peptides allowed match multiple proteins prior. , greedy set cover algorithm applied set proteins prior. TRUE, algorithm applied prior non-prior sets separately combining. See infer_parsimonious_accessions details. write_results_to_file (logical) Whether write results files. output_folder (character) Output folder name save results. provided, save current directory. save_env (logical) Whether save R environment output folder. return_results (logical) Whether return ratio rii results. verbose (logical) Whether show messages describing steps.","code":""},{"path":"/reference/run_plexedpiper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper for PlexedPiper — run_plexedpiper","text":"(list) return_results TRUE, returns list ratio RII data frames.","code":""},{"path":"/reference/run_plexedpiper.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrapper for PlexedPiper — run_plexedpiper","text":"","code":"if (FALSE) { results <- run_plexedpiper(msgf_output_folder = \"~/path/to/msgfplus/\",                            fasta_file  = \"~/path/to/fasta/sequence.fasta\",                            masic_output_folder = \"~/path/to/masic-results/\",                            ascore_output_folder = \"~/path/to/ascore-results/\",                            proteomics = \"ph\",                            study_design_folder = \"~/path/to/study-design/\",                            species = \"Rattus norvegicus\",                            annotation = \"RefSeq\",                            global_results = \"~/path/to/global/ratio.txt\",                            unique_only = FALSE,                            refine_prior = FALSE,                            output_folder = \"~/path/to/pp-results/\",                            file_prefix = \"msgfplus-pp-results\",                            return_results = TRUE,                            verbose = TRUE) }"},{"path":"/news/index.html","id":"plexedpiper-035-2022-04-28","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.3.5 (2022-04-28)","title":"PlexedPiper 0.3.5 (2022-04-28)","text":"Added unique_only refine_prior arguments run_plexedpiper. Requires update version MSnID built 2022-04-26–refine_prior argument added infer_parsimonious_accessions. Minor documentation changes.","code":""},{"path":"/news/index.html","id":"plexedpiper-034-2022-04-15","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.3.4 (2022-04-15)","title":"PlexedPiper 0.3.4 (2022-04-15)","text":"Added NEWS file. Added website built pkgdown package.","code":""},{"path":"/news/index.html","id":"plexedpiper-033-2022-04-14","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.3.3 (2022-04-14)","title":"PlexedPiper 0.3.3 (2022-04-14)","text":"Added run_plexedpiper wrapper function, performs steps necessary go MS-GF+ MASIC data Reporter Ion Intensity (RII) Ratio Results tables used MoTrPAC Bioinformatics Center (BIC).","code":""},{"path":"/news/index.html","id":"plexedpiper-032-2022-04-13","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.3.2 (2022-04-13)","title":"PlexedPiper 0.3.2 (2022-04-13)","text":"Added TMT6 TMT18 tables reporter_converter. Removed functions previously migrated PNNL.DMS.utils switch v0.3.0. Reduced computation time memory usage filter_msgf_data. added benefit increasing precision optimization algorithms. result, filtered MSnIDs may marginally different. Added UniProt support MoTrPAC BIC functions. Fixed check issues.","code":""},{"path":"/news/index.html","id":"plexedpiper-031-2021-09-22","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.3.1 (2021-09-22)","title":"PlexedPiper 0.3.1 (2021-09-22)","text":"Removed odbc package imports. Leftover changes v0.3.0.","code":""},{"path":"/news/index.html","id":"plexedpiper-030-2021-09-16","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.3.0 (2021-09-16)","title":"PlexedPiper 0.3.0 (2021-09-16)","text":"Migrated DMS-related tools PNNL.DMS.utils.","code":""},{"path":"/news/index.html","id":"plexedpiper-020-2021-06-07","dir":"Changelog","previous_headings":"","what":"PlexedPiper 0.2.0 (2021-06-07)","title":"PlexedPiper 0.2.0 (2021-06-07)","text":"First release since migration vladpetyuk/PlexedPiper. Updated read_study_design.","code":""}]
